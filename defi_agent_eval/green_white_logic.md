# Trading Agent Competition - å®Œæ•´å®ç°è®¡åˆ’

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

åŸºäºAgentBeatsæ¡†æ¶æ„å»ºå¤šAgentäº¤æ˜“ç«èµ›ç³»ç»Ÿï¼Œè¯„ä¼°ä¸åŒç­–ç•¥çš„äº¤æ˜“agentsåœ¨**2024å¹´11æœˆ14æ—¥è‡³12æœˆ14æ—¥**çœŸå®å¸‚åœºæ•°æ®ä¸­çš„è¡¨ç°ï¼Œæ ¸å¿ƒä¼˜åŒ–ç›®æ ‡ä¸º**å¤æ™®æ¯”ç‡ï¼ˆSharpe Ratioï¼‰**ã€‚

---

## ğŸ¯ æ ¸å¿ƒç›®æ ‡

1. **å…¬å¹³ç«èµ›**ï¼šæ‰€æœ‰agentsåœ¨ç›¸åŒå¸‚åœºæ¡ä»¶ä¸‹ç«äº‰
2. **å¤æ™®ä¼˜åŒ–**ï¼šå¥–åŠ±é«˜æ”¶ç›Š+ä½æ³¢åŠ¨çš„ç­–ç•¥
3. **å®Œæ•´è¯„ä¼°**ï¼š13ä¸ªæ ¸å¿ƒæŒ‡æ ‡ï¼Œ5ä¸ªè¯„åˆ†ç»´åº¦
4. **ç­–ç•¥å¯¹æ¯”**ï¼šæµ‹è¯•5ç§ä¸åŒäº¤æ˜“ç­–ç•¥çš„ä¼˜åŠ£

## â±ï¸ å†³ç­–å‘¨æœŸé…ç½®

### æ—¶é—´æ¡†æ¶

| å‚æ•° | å€¼ | è¯´æ˜ |
|------|-----|------|
| **å›æµ‹æœŸé—´** | 2024-11-14 è‡³ 2024-12-14 | 30å¤© |
| **æ•°æ®ç²’åº¦** | 4å°æ—¶Kçº¿ | ä»Binanceè·å–4h OHLCV |
| **å†³ç­–é¢‘ç‡** | æ¯4å°æ—¶ä¸€æ¬¡ | æ¯æ ¹Kçº¿è§¦å‘ä¸€æ¬¡AIå†³ç­– |
| **æ€»å†³ç­–æ¬¡æ•°** | 180æ¬¡ | 30å¤© Ã— 6æ¬¡/å¤© |
| **æŠ«éœ²é—´éš”** | æ¯7å¤© (çº¦42æ¬¡å†³ç­–) | Day 7, 14, 21æŠ«éœ² |


#### ä¸åŒé¢‘ç‡å¯¹æ¯”

| é¢‘ç‡ | å†³ç­–æ¬¡æ•°/agent | 5agentsæ€»è°ƒç”¨ | é¢„ä¼°æˆæœ¬ | å›æµ‹æ—¶é—´ | é€‚ç”¨åœºæ™¯ | æ¨èåº¦ |
|------|--------------|--------------|---------|---------|---------|--------|
| **3åˆ†é’Ÿ** | 14,400 | 72,000 | $500-1000 | 40å°æ—¶ | å®ç›˜é«˜é¢‘ | âŒ ä¸æ¨è |
| **15åˆ†é’Ÿ** | 2,880 | 14,400 | $100-200 | 8å°æ—¶ | æ—¥å†…äº¤æ˜“ | âš ï¸ æˆæœ¬é«˜ |
| **1å°æ—¶** | 720 | 3,600 | $25-50 | 2å°æ—¶ | æ—¥å†…/çŸ­çº¿ | âœ… å¯è¡Œ |
| **4å°æ—¶** | 180 | 900 | $6-12 | 30åˆ†é’Ÿ | Swingäº¤æ˜“ | âœ…âœ… æ¨è |
| **1å¤©** | 30 | 150 | $1-2 | 5åˆ†é’Ÿ | é•¿çº¿æŠ•èµ„ | âš ï¸ æ ·æœ¬å°‘ |

#### æ¨èæ–¹æ¡ˆï¼š4å°æ—¶ï¼ˆå›æµ‹ï¼‰+ 3åˆ†é’Ÿï¼ˆå®ç›˜ï¼‰

**å›æµ‹é˜¶æ®µï¼ˆéªŒè¯ç­–ç•¥ï¼‰ï¼š**
```toml
timeframe = "4h"
total_cycles = 180
purpose = "ç­–ç•¥éªŒè¯ã€å‚æ•°ä¼˜åŒ–ã€é£é™©è¯„ä¼°"
```

**å®ç›˜é˜¶æ®µï¼ˆçœŸå®äº¤æ˜“ï¼‰ï¼š**
```toml
timeframe = "3m"
purpose = "å®æ—¶ç›‘æ§ã€å¿«é€Ÿå“åº”"
note = "ä½†ä¸æ„å‘³ç€æ¯3åˆ†é’Ÿéƒ½äº¤æ˜“ï¼å¤§å¤šæ•°æ—¶å€™æ˜¯wait"
```



#### çµæ´»é…ç½®æ–¹æ¡ˆ

```toml
[scenario.config]
# å¿«é€Ÿæµ‹è¯•ï¼ˆé™ä½æˆæœ¬ï¼‰
# timeframe = "1d"
# total_cycles = 30

# æ ‡å‡†å›æµ‹ï¼ˆæ¨èï¼‰
timeframe = "4h"
total_cycles = 180

# ç²¾ç»†å›æµ‹ï¼ˆæˆæœ¬è¾ƒé«˜ï¼‰
# timeframe = "1h"
# total_cycles = 720

# å®ç›˜æ¨¡å¼ï¼ˆéœ€è¦å®æ—¶æ•°æ®æµï¼‰
# timeframe = "3m"
# total_cycles = 14400
# real_time_mode = true
```

### å†³ç­–æ—¶é—´ç‚¹ç¤ºä¾‹

```
2024-11-14:
  00:00 - å†³ç­–#1
  04:00 - å†³ç­–#2
  08:00 - å†³ç­–#3
  12:00 - å†³ç­–#4
  16:00 - å†³ç­–#5
  20:00 - å†³ç­–#6

2024-11-15:
  00:00 - å†³ç­–#7
  04:00 - å†³ç­–#8
  ...

2024-11-21 00:00 - å†³ç­–#42 â†’ ğŸ“¢ æŠ«éœ²ç‚¹1
2024-11-28 00:00 - å†³ç­–#84 â†’ ğŸ“¢ æŠ«éœ²ç‚¹2
2024-12-05 00:00 - å†³ç­–#126 â†’ ğŸ“¢ æŠ«éœ²ç‚¹3
2024-12-14 20:00 - å†³ç­–#180 â†’ ğŸ ç«èµ›ç»“æŸ
```

### âš¡ å…³é”®ï¼š4å°æ—¶å†³ç­– + 3åˆ†é’Ÿçº§åˆ«æ•°æ®

è™½ç„¶æˆ‘ä»¬æ¯4å°æ—¶åšä¸€æ¬¡å†³ç­–ï¼Œä½†å¯ä»¥åœ¨promptä¸­æä¾›**æœ€è¿‘çš„3åˆ†é’ŸKçº¿æ•°æ®**ï¼Œè®©AIæœ‰æ›´ç»†ç²’åº¦çš„ä¿¡æ¯ï¼š

```python
# å½“å‰æ—¶é—´: 2024-11-14 12:00 (å†³ç­–#4)

# æä¾›ç»™AIçš„æ•°æ®ï¼š
recent_3m_candles = get_klines(
    symbol="BTCUSDT",
    interval="3m",
    start="2024-11-14 08:00",  # æœ€è¿‘4å°æ—¶
    end="2024-11-14 12:00"
)  # è¿”å›80æ ¹3åˆ†é’ŸKçº¿

# Promptä¸­å±•ç¤ºä¸ºï¼š
"""
Intraday series (3-minute intervals, æœ€è¿‘80æ ¹Kçº¿):
Mid prices: [87234.50, 87245.30, 87256.80, ... (80ä¸ªä»·æ ¼)]
Volume: [152345, 153456, 154567, ... (80ä¸ªæˆäº¤é‡)]
EMA20 on 3m: [87123.45, 87134.56, ... (åŸºäº3åˆ†é’Ÿè®¡ç®—çš„EMA)]
"""

# ä½†agentåªéœ€è¦åœ¨12:00è¿™ä¸ªæ—¶é—´ç‚¹åšä¸€æ¬¡å†³ç­–
```

**ä¼˜åŠ¿ï¼š**
- âœ… AIçœ‹åˆ°ç»†ç²’åº¦çš„ä»·æ ¼æ³¢åŠ¨å’Œæˆäº¤é‡å˜åŒ–
- âœ… å¯ä»¥åˆ†æçŸ­æœŸè¶‹åŠ¿å’Œæ”¯æ’‘/é˜»åŠ›
- âœ… å†³ç­–è´¨é‡æ›´é«˜ï¼ˆä¿¡æ¯æ›´ä¸°å¯Œï¼‰
- âœ… ä½†åªå†³ç­–180æ¬¡ï¼Œæˆæœ¬å¯æ§

**å®ç°ï¼š**
```python
def build_market_prompt(self, agent_name: str, cycle_idx: int, timestamp: pd.Timestamp):
    # å†³ç­–æ—¶é—´ç‚¹ï¼šæ¯4å°æ—¶
    decision_time = timestamp  # ä¾‹å¦‚ï¼š2024-11-14 12:00
    
    # è·å–4å°æ—¶Kçº¿ï¼ˆç”¨äºé•¿æœŸè¶‹åŠ¿ï¼‰
    df_4h = self.data_4h.loc[:decision_time]
    
    # è·å–æœ€è¿‘4å°æ—¶çš„3åˆ†é’ŸKçº¿ï¼ˆç”¨äºçŸ­æœŸåˆ†æï¼‰
    lookback_start = decision_time - pd.Timedelta(hours=4)
    df_3m = get_klines_3m(symbol, lookback_start, decision_time)
    
    prompt = f"""
æ—¶é—´: {decision_time} | å‘¨æœŸ: #{cycle_idx} | Round {self.current_round}

BTCå½“å‰ä»·: {df_4h['close'].iloc[-1]}

## é•¿æœŸè¶‹åŠ¿ï¼ˆ4å°æ—¶çº§åˆ«ï¼Œæœ€è¿‘10æ ¹Kçº¿ï¼‰
OHLCV: ...
EMA20/50, MACD, RSI: ...

## çŸ­æœŸæ³¢åŠ¨ï¼ˆ3åˆ†é’Ÿçº§åˆ«ï¼Œæœ€è¿‘80æ ¹Kçº¿ï¼‰
Intraday prices: [{df_3m['close'].tolist()[-80:]}]
Volume: [{df_3m['volume'].tolist()[-80:]}]
EMA indicators (20-period on 3m): [...]

åŸºäºä»¥ä¸Šä¿¡æ¯ï¼Œåšå‡ºä½ çš„äº¤æ˜“å†³ç­–ã€‚
"""
```



### å¯é…ç½®çš„å†³ç­–é¢‘ç‡

å¦‚æœéœ€è¦è°ƒæ•´ï¼Œå¯åœ¨ `scenario.toml` ä¸­é…ç½®ï¼š

```toml
[scenario.config]
start_date = "2024-11-14"
end_date = "2024-12-14"

# å†³ç­–é¢‘ç‡é…ç½®
decision_timeframe = "4h"              # AIåšå†³ç­–çš„é¢‘ç‡: "1h", "4h", "1d"
decisions_per_day = 6                  # è‡ªåŠ¨è®¡ç®—: 24h / timeframe
total_decision_cycles = 180            # 30å¤© Ã— 6æ¬¡/å¤©

# æ•°æ®ç²’åº¦é…ç½®ï¼ˆæä¾›ç»™AIçœ‹çš„æ•°æ®ï¼‰
data_granularity = "3m"                # æä¾›3åˆ†é’Ÿçº§åˆ«çš„ç»†ç²’åº¦æ•°æ®
intraday_lookback_hours = 4            # æ¯æ¬¡å†³ç­–æ—¶ï¼Œæä¾›æœ€è¿‘4å°æ—¶çš„3åˆ†é’Ÿæ•°æ®
intraday_candles_count = 80            # 4å°æ—¶ Ã· 3åˆ†é’Ÿ = 80æ ¹Kçº¿

# è¿™æ ·è®¾è®¡çš„å¥½å¤„ï¼š
# - AIæ¯4å°æ—¶å†³ç­–ä¸€æ¬¡ï¼ˆæˆæœ¬å¯æ§ï¼‰
# - ä½†èƒ½çœ‹åˆ°3åˆ†é’Ÿçº§åˆ«çš„ä»·æ ¼æ³¢åŠ¨ï¼ˆä¿¡æ¯ä¸°å¯Œï¼‰
# - ç±»ä¼¼å®ç›˜çš„"æ¯3åˆ†é’Ÿæ‰«æï¼Œä½†ä¸ä¸€å®šæ¯æ¬¡éƒ½äº¤æ˜“"
```

---


## ğŸ“ æ–‡ä»¶ç»“æ„

```
tutorial/scenarios/trading/
â”œâ”€â”€ models.py                    # æ•°æ®æ¨¡å‹ 
â”œâ”€â”€ trading_evaluator.py         # Green Agent 
â”œâ”€â”€ trading_agent.py             # White Agent 
â”œâ”€â”€ scenario.toml                # é…ç½®æ–‡ä»¶ 
â”œâ”€â”€ README.md                    # ä½¿ç”¨æ–‡æ¡£
â”œâ”€â”€ requirements.txt             # ä¾èµ–
â””â”€â”€ data/
    â””â”€â”€ cache/                   # APIæ•°æ®ç¼“å­˜
```

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### 1. Green Agent (TradingEvaluator)

**èŒè´£ï¼š**
- ä»Binance APIåŠ è½½2024-11-14è‡³2024-12-14çš„å†å²æ•°æ®
  - **4å°æ—¶Kçº¿**ï¼šç”¨äºå†³ç­–æ—¶é—´ç‚¹ï¼ˆ180ä¸ªå†³ç­–å‘¨æœŸï¼‰
  - **3åˆ†é’ŸKçº¿**ï¼šç”¨äºæä¾›ç»†ç²’åº¦å¸‚åœºä¿¡æ¯
- è®¡ç®—æŠ€æœ¯æŒ‡æ ‡ï¼ˆEMA20/50, MACD, RSI7/14, ATR14ï¼‰
  - 4å°æ—¶çº§åˆ«ï¼šé•¿æœŸè¶‹åŠ¿
  - 3åˆ†é’Ÿçº§åˆ«ï¼šçŸ­æœŸæ³¢åŠ¨
- æ¯4å°æ—¶æ„å»ºå®Œæ•´å¸‚åœºpromptï¼ˆåŒ…å«OHLCV + æŒ‡æ ‡ + è´¦æˆ·çŠ¶æ€ï¼‰
- å‘é€ç»™æ‰€æœ‰White Agentsï¼Œæ”¶é›†XMLæ ¼å¼å†³ç­–
- **â­ ä½¿ç”¨LLMè¯„ä¼°reasoningè´¨é‡**
  - è¯„ä¼°Decision Processéµå¾ªåº¦
  - è¯„ä¼°æŠ€æœ¯åˆ†æå‡†ç¡®æ€§
  - è¯„ä¼°é£é™©è¯„ä¼°åˆç†æ€§
  - è¯„ä¼°é€»è¾‘ä¸€è‡´æ€§
  - ç”Ÿæˆreasoningåˆ†æ•°ï¼ˆ0-1ï¼‰
- åœ¨éš”ç¦»è´¦æˆ·ä¸­æ‰§è¡Œäº¤æ˜“ï¼ˆåº”ç”¨è´¹ç”¨5bpsã€æ»‘ç‚¹2bpsï¼‰
- è®¡ç®—13ä¸ªæ ¸å¿ƒæŒ‡æ ‡ï¼Œ5ä¸ªè¯„åˆ†ç»´åº¦
- **ç»¼åˆè¯„åˆ†**ï¼šäº¤æ˜“ç»©æ•ˆï¼ˆ70%ï¼‰+ Reasoningè´¨é‡ï¼ˆ30%ï¼‰
- æœ€ç»ˆæ’åï¼Œå®£å¸ƒè·èƒœè€…

**å…³é”®æ–¹æ³•ï¼š**
```python
class TradingEvaluatorTools:
    # æ•°æ®å‡†å¤‡
    def load_and_prepare_data()           # åŠ è½½å†å²æ•°æ®+è®¡ç®—æ‰€æœ‰æŠ€æœ¯æŒ‡æ ‡
    def _fetch_from_binance()             # ä»Binance APIè·å–Kçº¿æ•°æ®
    def _fetch_4h_klines()                # è·å–4å°æ—¶Kçº¿ï¼ˆå†³ç­–æ—¶é—´ç‚¹ï¼‰
    def _fetch_3m_klines()                # è·å–3åˆ†é’ŸKçº¿ï¼ˆç»†ç²’åº¦æ•°æ®ï¼‰
    def _calculate_indicators()           # è®¡ç®—EMA/MACD/RSI/ATR
    def _calculate_indicators_4h()        # 4å°æ—¶æŒ‡æ ‡ï¼ˆè¶‹åŠ¿ï¼‰
    def _calculate_indicators_3m()        # 3åˆ†é’ŸæŒ‡æ ‡ï¼ˆçŸ­æœŸï¼‰
    
    # Promptæ„å»º â­ æ ¸å¿ƒ
    def build_market_prompt(agent_name)   # æ„å»ºä¸ªæ€§åŒ–prompt
    def _read_agent_positions(agent)      # è¯»å–è¯¥agentçš„æŒä»“ï¼ˆä»BacktestAccountï¼‰
    def _format_position(position)        # æ ¼å¼åŒ–å•ä¸ªæŒä»“ä¿¡æ¯
    def _format_candidate(symbol, day)    # æ ¼å¼åŒ–å€™é€‰å¸ç§ä¿¡æ¯
    def _get_candidate_symbols()          # è·å–å€™é€‰å¸ç§åˆ—è¡¨
    
    # Agenté€šä¿¡
    async def get_agent_decision()        # é€šè¿‡A2Aè·å–å†³ç­–
    def parse_xml_decision()              # è§£æXMLå“åº”
    
    # äº¤æ˜“æ‰§è¡Œ
    def execute_decision()                # åœ¨agentçš„BacktestAccountä¸­æ‰§è¡Œ
    def _execute_open_long()              # å¼€å¤šä»“
    def _execute_close_long()             # å¹³å¤šä»“
    
    # æŒ‡æ ‡è®¡ç®—
    def calculate_sharpe_ratio()          # è®¡ç®—å¤æ™®æ¯”ç‡
    def calculate_performance()           # å®Œæ•´è¯„ä¼°ï¼ˆ13ä¸ªæŒ‡æ ‡ï¼‰
    
    # LLMè¯„ä¼° â­ æ–°å¢ï¼ˆå‚è€ƒdebate judgeï¼‰
    async def evaluate_reasoning()        # ä½¿ç”¨LLMè¯„ä¼°reasoningè´¨é‡
    def _build_evaluation_prompt()        # æ„å»ºè¯„ä¼°prompt
    def _calculate_reasoning_score()      # è®¡ç®—reasoningç»¼åˆåˆ†æ•°
    
    # å¤šè½®äº¤äº’
    def store_round_decision()            # å­˜å‚¨agentçš„è¯¥è½®å†³ç­–
    def create_disclosure_package()       # åˆ›å»ºæŠ«éœ²åŒ…ï¼ˆåœ¨Day 7/14/21ï¼‰
    def format_intelligence_report()      # æ ¼å¼åŒ–å¯¹æ‰‹æƒ…æŠ¥ï¼ˆæ·»åŠ åˆ°promptï¼‰
    def _parse_reasoning_structure()      # ä»reasoningä¸­æå–market_viewç­‰
    def _get_current_leaderboard()        # ç”Ÿæˆå½“å‰æ’è¡Œæ¦œ
```

**æŒä»“è¯»å–æµç¨‹ï¼š**
```python
def _read_agent_positions(self, agent_name: str) -> List[Position]:
    """è¯»å–agentçš„å½“å‰æŒä»“"""
    account = self.accounts[agent_name]  # è·å–è¯¥agentçš„ç‹¬ç«‹è´¦æˆ·
    positions = account.get_positions()   # ä»BacktestAccountè¯»å–æŒä»“
    
    # è¿”å›æŒä»“åˆ—è¡¨ï¼Œå¯èƒ½ä¸ºç©º
    return positions

# åœ¨build_market_promptä¸­ä½¿ç”¨ï¼š
positions = self._read_agent_positions(agent_name)
if positions:
    prompt += "## å½“å‰æŒä»“\n"
    for i, pos in enumerate(positions, 1):
        prompt += self._format_position(pos, i, current_prices)
else:
    prompt += "## å½“å‰æŒä»“\næ— æŒä»“\n"
```

**å€™é€‰å¸ç§æä¾›æµç¨‹ï¼š**
```python
def _get_candidate_symbols(self) -> List[str]:
    """è·å–å€™é€‰å¸ç§åˆ—è¡¨ï¼ˆä»é…ç½®ï¼‰"""
    return self.config['symbols']  # ["BTCUSDT", "ETHUSDT", "SOLUSDT"]

# åœ¨build_market_promptä¸­ä½¿ç”¨ï¼š
prompt += "\n## å€™é€‰å¸ç§\n"
for symbol in self._get_candidate_symbols():
    symbol_data = self.historical_data[symbol].iloc[:current_day+1]
    prompt += self._format_candidate(symbol, symbol_data)
```

---

## ğŸ”„ å¤šè½®äº¤äº’æœºåˆ¶ï¼ˆæ ¸å¿ƒç‰¹æ€§ï¼‰

### ä¸ºä»€ä¹ˆéœ€è¦å¤šè½®äº¤äº’ï¼Ÿ

**é—®é¢˜**ï¼šç®€å•çš„å•å‘äº¤äº’ï¼ˆGreenå‘æ•°æ® â†’ Whiteè¿”å›å†³ç­–ï¼‰ç¼ºå°‘ç­–ç•¥åšå¼ˆæ·±åº¦
**è§£å†³**ï¼šå¼•å…¥æŠ«éœ²ç‚¹æœºåˆ¶ï¼Œè®©agentsèƒ½å¤Ÿåˆ†æå¯¹æ‰‹ã€è°ƒæ•´ç­–ç•¥

### äº¤äº’æ—¶é—´çº¿ï¼ˆåŸºäº4å°æ—¶å‘¨æœŸï¼‰

```
â”œâ”€ å†³ç­–#1-42 (Day 1-7): Round 1 ã€ç›²äº¤æ˜“æœŸã€‘
â”‚  â”œâ”€ 42æ¬¡ç‹¬ç«‹å†³ç­–ï¼ˆ7å¤© Ã— 6æ¬¡/å¤©ï¼‰
â”‚  â”œâ”€ Agentsåªçœ‹åˆ°ï¼šå¸‚åœºæ•°æ® + è‡ªå·±çš„è´¦æˆ·
â”‚  â”œâ”€ æ— å¯¹æ‰‹ä¿¡æ¯
â”‚  â””â”€ Greenè®°å½•æ‰€æœ‰reasoningï¼ˆæš‚ä¸æŠ«éœ²ï¼‰
â”‚
â”œâ”€ å†³ç­–#42 (Day 7 00:00): ğŸ“¢ æŠ«éœ²ç‚¹1
â”‚  â””â”€ å…¬å¼€æ‰€æœ‰agentsçš„ï¼š
â”‚     â”œâ”€ Round 1çš„42æ¬¡reasoningå’Œå¸‚åœºè§‚ç‚¹
â”‚     â”œâ”€ å½“å‰æŒä»“æ˜ç»†
â”‚     â”œâ”€ å½“å‰PnLæ’å
â”‚     â””â”€ æ‰§è¡Œçš„æ‰€æœ‰åŠ¨ä½œ
â”‚
â”œâ”€ å†³ç­–#43-84 (Day 8-14): Round 2 ã€æƒ…æŠ¥äº¤æ˜“æœŸã€‘
â”‚  â”œâ”€ 42æ¬¡å†³ç­–ï¼ˆå¸¦æƒ…æŠ¥ï¼‰
â”‚  â”œâ”€ Agentsæ”¶åˆ°ï¼š
â”‚  â”‚  â”œâ”€ å¸‚åœºæ•°æ®
â”‚  â”‚  â”œâ”€ è‡ªå·±çš„è´¦æˆ·
â”‚  â”‚  â””â”€ ğŸ“Š æŠ«éœ²ç‚¹1çš„å®Œæ•´æƒ…æŠ¥ â­
â”‚  â””â”€ Agentså¯ä»¥ï¼š
â”‚     â”œâ”€ åˆ†æå¯¹æ‰‹reasoningè´¨é‡ï¼ˆ42æ¬¡å†å²ï¼‰
â”‚     â”œâ”€ åˆ¤æ–­è°çš„ç­–ç•¥æœ‰æ•ˆ
â”‚     â””â”€ å†³å®šè·Ÿéš/å¯¹æŠ—/ç‹¬ç«‹
â”‚
â”œâ”€ å†³ç­–#84 (Day 14 00:00): ğŸ“¢ æŠ«éœ²ç‚¹2
â”‚  â””â”€ å…¬å¼€Round 2ä¿¡æ¯ï¼ˆåŒ…å«å¯¹æ‰‹åˆ†æï¼‰
â”‚
â”œâ”€ å†³ç­–#85-126 (Day 15-21): Round 3 ã€æ·±åº¦åšå¼ˆæœŸã€‘
â”‚  â”œâ”€ 42æ¬¡å†³ç­–
â”‚  â””â”€ AgentsåŸºäºæŠ«éœ²1+2è¿›è¡Œå¤šæ­¥æ¨ç†
â”‚
â”œâ”€ å†³ç­–#126 (Day 21 00:00): ğŸ“¢ æŠ«éœ²ç‚¹3
â”‚  â””â”€ æœ€ç»ˆæŠ«éœ²
â”‚
â””â”€ å†³ç­–#127-180 (Day 22-30): Round 4 ã€ç»ˆå±€æœŸã€‘
   â”œâ”€ 54æ¬¡å†³ç­–
   â””â”€ åŸºäºæ‰€æœ‰å†å²æƒ…æŠ¥çš„æœ€ç»ˆå¯¹å†³

æ€»è®¡ï¼š180æ¬¡AIå†³ç­– / agentï¼Œå…±900æ¬¡å†³ç­–ï¼ˆ5ä¸ªagentsï¼‰
```

### é…ç½®å‚æ•°

```toml
[scenario.config]
# åŸºç¡€é…ç½®
symbols = ["BTCUSDT", "ETHUSDT", "SOLUSDT"]
start_date = "2024-11-14"
end_date = "2024-12-14"
timeframe = "4h"                                 # å†³ç­–å‘¨æœŸï¼š4å°æ—¶
total_days = 30
initial_balance = 10000.0

# å†³ç­–é¢‘ç‡
decisions_per_day = 6                            # 24h / 4h = 6æ¬¡/å¤©
total_decision_cycles = 180                      # 30å¤© Ã— 6æ¬¡ = 180æ¬¡

# å¤šè½®äº¤äº’é…ç½® â­ æ–°å¢
enable_multi_round = true                        # æ˜¯å¦å¯ç”¨å¤šè½®äº¤äº’
num_disclosure_rounds = 3                        # æŠ«éœ²æ¬¡æ•°
disclosure_cycles = [42, 84, 126]                # å“ªäº›å†³ç­–å‘¨æœŸè¿›è¡ŒæŠ«éœ²
disclosure_days = [7, 14, 21]                    # å¯¹åº”çš„å¤©æ•°ï¼ˆå¯è¯»æ€§ï¼‰
disclosure_content = [                           # æŠ«éœ²å†…å®¹
    "reasoning",      # å¯¹æ‰‹çš„å¸‚åœºåˆ†æå’Œæ¨ç†
    "positions",      # å¯¹æ‰‹çš„æŒä»“
    "pnl",            # å¯¹æ‰‹çš„ç›ˆäº
    "actions"         # å¯¹æ‰‹æ‰§è¡Œçš„åŠ¨ä½œ
]
```

### æŠ«éœ²æ•°æ®æ ¼å¼

**å†³ç­–#42 (Day 7 00:00) æŠ«éœ²ç‚¹ç¤ºä¾‹ï¼š**

```
========================================
ğŸ“¢ DISCLOSURE POINT 1 - å†³ç­–#42 (Day 7 00:00)
Round 1 å®Œæˆï¼š42æ¬¡å†³ç­–
========================================

æ’å:
  ğŸ‘‘ MomentumTrader: +15.2% ($11,520)
  2. BalancedTrader: +8.7% ($10,870)
  3. ConservativeTrader: +5.1% ($10,510)
  4. AggressiveTrader: +2.3% ($10,230)
  5. MeanReversionTrader: -3.2% ($9,680)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

MomentumTraderçš„Round 1è¡¨ç° (42æ¬¡å†³ç­–):

å†³ç­–#8 (Day 2 08:00):
  å¸‚åœºè§‚ç‚¹: "BTCçªç ´$87ké˜»åŠ›ä½ï¼Œæˆäº¤é‡æ”¾å¤§ï¼Œè¶‹åŠ¿ç¡®ç«‹"
  é£é™©è¯„ä¼°: "ä¸­ç­‰é£é™©ï¼Œæ­¢æŸ$85k"
  åŠ¨ä½œ: å¼€å¤šä»“ BTC 0.3 @ $87,234 (5xæ æ†)
  æ¨ç†: "MACDé‡‘å‰ï¼ŒEMA20ä¸Šç©¿ï¼ŒRSIæœªè¶…ä¹°ï¼Œç¬¦åˆè¶‹åŠ¿è·Ÿéšä¿¡å·"

å†³ç­–#23 (Day 4 16:00):
  å¸‚åœºè§‚ç‚¹: "è¶‹åŠ¿å»¶ç»­ï¼Œå›è¸©æ”¯æ’‘åç»§ç»­ä¸Šæ¶¨"
  åŠ¨ä½œ: åŠ ä»“ BTC 0.2 @ $88,789
  æ¨ç†: "ä»·æ ¼å›è¸©EMA20è·å¾—æ”¯æ’‘ï¼Œæˆäº¤é‡æœªå‡ï¼Œç»§ç»­çœ‹æ¶¨"
  
[... å…¶ä»–40æ¬¡å†³ç­–æ‘˜è¦ ...]

å½“å‰æŒä»“:
  - BTC 0.5 Long @ avg $87,876 (æœªå®ç°PnL: +$614)

æ€»ç»“: æˆåŠŸåˆ¤æ–­è¶‹åŠ¿ï¼Œæ‰§è¡Œæœæ–­ âœ…

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

MeanReversionTraderçš„Round 1è¡¨ç° (42æ¬¡å†³ç­–):

å†³ç­–#14 (Day 3 04:00):
  å¸‚åœºè§‚ç‚¹: "BTC RSIè¾¾åˆ°70ï¼Œè¶…ä¹°ï¼Œé¢„æœŸå›è°ƒ"
  åŠ¨ä½œ: å¼€ç©ºä»“ BTC 0.4 @ $88,543 (3xæ æ†)
  æ¨ç†: "RSIè¶…ä¹°ä¿¡å·ï¼Œé¢„æœŸå›è°ƒè‡³$86k"

å†³ç­–#32 (Day 6 00:00):
  å¸‚åœºè§‚ç‚¹: "ç»§ç»­è¶…ä¹°ï¼ŒåŠ å¤§ç©ºä»“"
  åŠ¨ä½œ: åŠ ç©ºä»“ BTC 0.3 @ $89,012
  æ¨ç†: "RSIæŒç»­é«˜ä½ï¼Œå›è°ƒå³å°†åˆ°æ¥"
  
[... å…¶ä»–40æ¬¡å†³ç­–æ‘˜è¦ ...]

å½“å‰æŒä»“:
  - BTC 0.7 Short @ avg $88,732 (æœªå®ç°PnL: -$261)

æ€»ç»“: é€†åŠ¿æ“ä½œï¼Œåˆ¤æ–­å¤±è¯¯ âŒ

========================================
```

### White Agentå¦‚ä½•ä½¿ç”¨æŠ«éœ²ä¿¡æ¯

**Round 2æ—¶ï¼ˆå†³ç­–#43å¼€å§‹ï¼‰ï¼ŒBalancedTraderæ”¶åˆ°çš„promptä¼šåŒ…å«ï¼š**

```
æ—¶é—´: 2024-11-15 04:00 | å†³ç­–å‘¨æœŸ: #43 | Round 2

[... å½“å‰4å°æ—¶Kçº¿çš„å¸‚åœºæ•°æ® ...]
[... ä½ çš„è´¦æˆ·çŠ¶æ€ ...]
[... å€™é€‰å¸ç§ï¼ˆBTC/ETH/SOLï¼‰ ...]

========================================
å¯¹æ‰‹æƒ…æŠ¥ (INTELLIGENCE REPORT)
========================================

ã€æŠ«éœ²ç‚¹1 - å†³ç­–#42 (Day 7 00:00)ã€‘

æ’å:
  ğŸ‘‘ MomentumTrader: +15.2%
  2. BalancedTrader: +8.7% (ä½ )
  3. ConservativeTrader: +5.1%

å¯¹æ‰‹åˆ†æ:

MomentumTrader:
  Round 1å†³ç­–æ•°: 42æ¬¡ï¼Œå…¶ä¸­8æ¬¡å¼€ä»“/åŠ ä»“ï¼Œ34æ¬¡hold
  å…³é”®å¸‚åœºè§‚ç‚¹: "BTCè¶‹åŠ¿ç¡®ç«‹ï¼Œæˆäº¤é‡æ”¯æŒ"
  æ‰§è¡ŒåŠ¨ä½œ: å†³ç­–#8å¼€å¤š0.3 BTC, å†³ç­–#23åŠ ä»“0.2 BTC
  å½“æ—¶æŒä»“: BTC 0.5 Long @ $87,876
  Round 1 PnL: +15.2%
  
ConservativeTrader:
  Round 1å†³ç­–æ•°: 42æ¬¡ï¼Œå…¶ä¸­3æ¬¡å¼€ä»“ï¼Œ39æ¬¡wait/hold
  å…³é”®å¸‚åœºè§‚ç‚¹: "BTCçªç ´ä½†ä¿æŒè§‚æœ›ï¼Œç­‰å¾…ç¡®è®¤"
  æ‰§è¡ŒåŠ¨ä½œ: å†³ç­–#20å°ä»“ä½å¼€å¤š0.1 BTC
  å½“æ—¶æŒä»“: BTC 0.1 Long @ $88,234
  Round 1 PnL: +5.1%

MeanReversionTrader:
  Round 1å†³ç­–æ•°: 42æ¬¡ï¼Œå…¶ä¸­6æ¬¡é€†åŠ¿æ“ä½œ
  å…³é”®å¸‚åœºè§‚ç‚¹: "RSIè¶…ä¹°ï¼Œé¢„æœŸå›è°ƒ"
  æ‰§è¡ŒåŠ¨ä½œ: å†³ç­–#14å¼€ç©º0.4 BTC, å†³ç­–#32åŠ ç©º0.3 BTC
  å½“æ—¶æŒä»“: BTC 0.7 Short @ $88,732
  Round 1 PnL: -3.2%

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

åŸºäºä»¥ä¸Šæƒ…æŠ¥ï¼Œä½ ç°åœ¨å¯ä»¥ï¼š
1. è¯„ä¼°å¯¹æ‰‹çš„reasoningè´¨é‡
2. åˆ¤æ–­è°çš„ç­–ç•¥æœ‰æ•ˆ
3. å†³å®šä½ çš„ç­–ç•¥è°ƒæ•´

è¯·åœ¨<reasoning>ä¸­åŒ…å«<opponent_analysis>éƒ¨åˆ†ã€‚
```

**BalancedTraderçš„Round 2å†³ç­–å¯èƒ½æ˜¯ï¼š**

```xml
<summary>
åŸºäºMomentumTraderçš„æˆåŠŸæ¡ˆä¾‹ï¼Œå¢åŠ BTCæš´éœ²ï¼Œå¼€å¤šä»“
</summary>

<reasoning>
å¸‚åœºåˆ†æ: BTCç»§ç»­å¼ºåŠ¿ï¼Œçªç ´$89k

å¯¹æ‰‹åˆ†æ:
- MomentumTrader: ä»–çš„è¶‹åŠ¿åˆ¤æ–­å®Œå…¨æ­£ç¡®(+15.2%)ï¼Œ
  reasoningè´¨é‡é«˜("æˆäº¤é‡ç¡®è®¤"è¿™ä¸ªé€»è¾‘å¾ˆæ‰å®)
  ä»–å¯èƒ½ä¼šç»§ç»­æŒæœ‰æˆ–åŠ ä»“
  
- MeanReversionTrader: ä»–çš„é€†å‘ç­–ç•¥å¤±è´¥(-3.2%)ï¼Œ
  è¯´æ˜å½“å‰å¸‚åœºè¶‹åŠ¿æ€§å¼ºï¼Œä¸é€‚åˆé€†å‘
  ä»–å¯èƒ½è¢«è¿«æ­¢æŸ
  
- ConservativeTrader: å¤ªä¿å®ˆï¼Œé”™è¿‡äº†å¤§éƒ¨åˆ†æ¶¨å¹…

ç­–ç•¥è°ƒæ•´:
æˆ‘åœ¨Round 1è¿‡äºè°¨æ…ï¼Œç°åœ¨æ˜ç¡®è¶‹åŠ¿å‘ä¸Šã€‚
å‚è€ƒMomentumTraderçš„æˆåŠŸç»éªŒï¼Œæˆ‘åº”è¯¥å¢åŠ BTCä»“ä½ã€‚
ä½†é¿å…åƒä»–é‚£æ ·æ¿€è¿›ï¼Œä½¿ç”¨3xæ æ†è€Œé5xã€‚

æœ€ç»ˆå†³ç­–: å¼€å¤šä»“BTCï¼Œæ æ†3xï¼Œä»“ä½ä»·å€¼$2000
</reasoning>

<decision>
[
  {
    "symbol": "BTCUSDT",
    "action": "open_long",
    "leverage": 3,
    "quantity": 0.067,
    "stop_loss": 86000,
    "take_profit": 92000,
    "confidence": 0.75,
    "risk_usd": 200,
    "reasoning": "è·ŸéšMomentumTraderçš„æˆåŠŸç­–ç•¥ï¼Œä½†é™ä½æ æ†"
  }
]
</decision>
```

---

### 2. White Agents (Trading Agents)

**5ç§ç­–ç•¥ï¼š**

| ç­–ç•¥ | æ æ† | é¢‘ç‡ | é£æ ¼ | é¢„æœŸè¡¨ç° |
|------|------|------|------|----------|
| Conservative | 1-3x | ä½ (0.4/å¤©) | èµ„æœ¬ä¿æŠ¤ | ç¨³å¥ï¼Œä½æ”¶ç›Š |
| Balanced | 3-5x | ä¸­ (0.6/å¤©) | ç†æ€§åˆ†æ | æœ€ä¼˜é£é™©è°ƒæ•´æ”¶ç›Š |
| Aggressive | 5-20x | é«˜ (1.5/å¤©) | é«˜é£é™©é«˜å›æŠ¥ | é«˜æ”¶ç›Šä½†æ³¢åŠ¨å¤§ |
| Momentum | 3-8x | ä¸­é«˜ (0.9/å¤©) | è¶‹åŠ¿è·Ÿéš | ç‰›å¸‚è¡¨ç°ä¼˜ç§€ |
| MeanReversion | 2-5x | é«˜ (1.1/å¤©) | é€†åŠ¿äº¤æ˜“ | è¶‹åŠ¿å¸‚åœºè¡¨ç°å·® |

**å†³ç­–æµç¨‹ï¼ˆDecision Processï¼‰ï¼š**

æ¯ä¸ªWhite Agentåœ¨æ”¶åˆ°market promptåï¼Œå¿…é¡»æŒ‰ç…§ä»¥ä¸‹æµç¨‹è¿›è¡Œå†³ç­–ï¼š

```
ğŸ“‹ DECISION PROCESS (å¿…é¡»éµå¾ª)

Step 1: æ£€æŸ¥ç°æœ‰æŒä»“ (Check Positions)
   â”œâ”€ éå†å½“å‰æŒä»“åˆ—è¡¨
   â”œâ”€ æ£€æŸ¥æ¯ä¸ªæŒä»“çš„ç›ˆäºæƒ…å†µ
   â”œâ”€ åˆ¤æ–­æ˜¯å¦è§¦å‘æ­¢ç›ˆæ¡ä»¶ï¼š
   â”‚  â””â”€ ç›ˆåˆ©è¾¾åˆ°ç›®æ ‡ or å›æ’¤è¶…è¿‡é˜ˆå€¼ â†’ è€ƒè™‘å¹³ä»“
   â”œâ”€ åˆ¤æ–­æ˜¯å¦è§¦å‘æ­¢æŸæ¡ä»¶ï¼š
   â”‚  â””â”€ äºæŸè¾¾åˆ°æ­¢æŸç‚¹ or è¶‹åŠ¿åè½¬ â†’ å¿…é¡»å¹³ä»“
   â””â”€ è¾“å‡º: å¯¹ç°æœ‰æŒä»“çš„æ“ä½œå†³ç­–

Step 2: æ‰«æå€™é€‰å¸ç§ (Scan Candidates)
   â”œâ”€ éå†æ‰€æœ‰å€™é€‰å¸ç§ï¼ˆBTC/ETH/SOLï¼‰
   â”œâ”€ å¤šæ—¶é—´æ¡†æ¶åˆ†æï¼š
   â”‚  â”œâ”€ 4å°æ—¶çº§åˆ«: åˆ¤æ–­ä¸»è¶‹åŠ¿æ–¹å‘
   â”‚  â””â”€ 3åˆ†é’Ÿçº§åˆ«: å¯»æ‰¾å…¥åœºæ—¶æœº
   â”œâ”€ æ£€æŸ¥æ˜¯å¦å­˜åœ¨å¼ºä¿¡å·ï¼š
   â”‚  â”œâ”€ è¶‹åŠ¿ä¿¡å·: EMAäº¤å‰ã€MACDé‡‘å‰/æ­»å‰
   â”‚  â”œâ”€ åŠ¨é‡ä¿¡å·: RSIçªç ´ã€æˆäº¤é‡ç¡®è®¤
   â”‚  â””â”€ å½¢æ€ä¿¡å·: çªç ´å…³é”®ä»·ä½
   â””â”€ è¾“å‡º: æ½œåœ¨çš„æ–°å¼€ä»“æœºä¼š

Step 3: é£é™©è¯„ä¼° (Risk Assessment)
   â”œâ”€ å½“å‰è´¦æˆ·é£é™©æ•å£
   â”œâ”€ æ–°å¼€ä»“æ˜¯å¦ä¼šå¯¼è‡´è¿‡åº¦æ æ†
   â”œâ”€ å¸‚åœºæ³¢åŠ¨ç‡è¯„ä¼°
   â””â”€ è¾“å‡º: æ˜¯å¦å…è®¸æ–°å¼€ä»“

Step 4: ç»¼åˆå†³ç­– (Final Decision)
   â”œâ”€ ä¼˜å…ˆçº§1: å¤„ç†ç°æœ‰æŒä»“ï¼ˆæ­¢ç›ˆ/æ­¢æŸï¼‰
   â”œâ”€ ä¼˜å…ˆçº§2: å¼€æ–°ä»“ä½ï¼ˆå¦‚æœé£é™©å…è®¸ï¼‰
   â”œâ”€ ä¼˜å…ˆçº§3: æŒæœ‰æˆ–ç­‰å¾…ï¼ˆå¦‚æœæ— æ˜ç¡®ä¿¡å·ï¼‰
   â””â”€ è¾“å‡º: æœ€ç»ˆåŠ¨ä½œåˆ—è¡¨

Step 5: ç»“æ„åŒ–è¾“å‡º (Structured Output)
   â”œâ”€ å…ˆå†™ <summary>: ä¸€å¥è¯æ€»ç»“å†³ç­–
   â”œâ”€ å†å†™ <reasoning>: å®Œæ•´çš„æ€ç»´é“¾
   â”‚  â”œâ”€ å½“å‰æŒä»“åˆ†æï¼ˆStep 1ï¼‰
   â”‚  â”œâ”€ å€™é€‰å¸æ‰«æç»“æœï¼ˆStep 2ï¼‰
   â”‚  â”œâ”€ é£é™©è¯„ä¼°ï¼ˆStep 3ï¼‰
   â”‚  â”œâ”€ å¯¹æ‰‹åˆ†æï¼ˆRound 2+ï¼‰
   â”‚  â””â”€ æœ€ç»ˆå†³ç­–é€»è¾‘ï¼ˆStep 4ï¼‰
   â””â”€ æœ€åå†™ <decision>: JSONæ ¼å¼çš„åŠ¨ä½œ
```

**è¾“å‡ºæ ¼å¼ï¼ˆXMLï¼‰- éµå¾ªDecision Processï¼š**

```xml
<summary>
BTCæŒä»“ç›ˆåˆ©+5.2%è¾¾æ­¢ç›ˆç›®æ ‡ï¼Œå¹³ä»“è·åˆ©ï¼›ETHå‡ºç°å¤šå¤´ä¿¡å·ï¼Œå¼€ä»“åšå¤š
</summary>

<reasoning>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Step 1: æ£€æŸ¥ç°æœ‰æŒä»“ (Check Positions)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

å½“å‰æŒä»“1ä¸ªï¼š
- BTC Long: å…¥åœºä»·$87,234, å½“å‰ä»·$91,768, ç›ˆåˆ©+5.2% (+$453 USDT)
  
æŒä»“åˆ†æï¼š
âœ“ ç›ˆåˆ©å·²è¾¾åˆ°é¢„æœŸç›®æ ‡ï¼ˆè®¾å®š4-6%ï¼‰
âœ“ çŸ­æœŸ3åˆ†é’ŸEMAå¼€å§‹èµ°å¹³ï¼Œä¸Šæ¶¨åŠ¨èƒ½å‡å¼±
âœ“ RSI7è¾¾åˆ°72ï¼Œè¿›å…¥è¶…ä¹°åŒºåŸŸ
âœ“ å†³ç­–ï¼šå¹³ä»“æ­¢ç›ˆï¼Œé”å®šåˆ©æ¶¦

invalidation_condition: å¦‚æœä»·æ ¼çªç ´$93,000å¹¶æ”¾é‡ï¼Œåˆ™ä¸å¹³ä»“

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Step 2: æ‰«æå€™é€‰å¸ç§ (Scan Candidates)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

BTCUSDT:
- 4Hè¶‹åŠ¿ï¼šä¸Šæ¶¨ä½†æ¥è¿‘è¶…ä¹°
- 3Mæ³¢åŠ¨ï¼šæœ€è¿‘80æ ¹Kçº¿æ˜¾ç¤ºéœ‡è¡
- ä¿¡å·å¼ºåº¦ï¼šä¸­æ€§ï¼Œæš‚æ—¶è§‚æœ›
- ç»“è®ºï¼šåˆšå¹³ä»“ï¼Œç­‰å¾…å›è°ƒ

ETHUSDT:
- 4Hè¶‹åŠ¿ï¼šåˆšçªç ´EMA50ï¼Œè¶‹åŠ¿è½¬å¤š â­
- 3Mæ³¢åŠ¨ï¼šæœ€è¿‘20æ ¹Kçº¿æŒç»­æ”¾é‡ä¸Šæ¶¨
- æŠ€æœ¯ä¿¡å·ï¼š
  * MACD 4Hé‡‘å‰ï¼ˆ0.15 > Signal 0.08ï¼‰
  * EMA20ä¸Šç©¿EMA50ï¼ˆ3142 > 3100ï¼‰
  * RSI7=58ï¼ˆæœªè¶…ä¹°ï¼Œæœ‰ç©ºé—´ï¼‰
  * æˆäº¤é‡ï¼šå½“å‰15.2M > å¹³å‡12.5M (+21.6%)
- ä¿¡å·å¼ºåº¦ï¼šå¼º âœ…
- ç»“è®ºï¼šå­˜åœ¨æ˜ç¡®åšå¤šæœºä¼š

SOLUSDT:
- 4Hè¶‹åŠ¿ï¼šéœ‡è¡ï¼Œæ— æ˜ç¡®æ–¹å‘
- ä¿¡å·å¼ºåº¦ï¼šå¼±
- ç»“è®ºï¼šè§‚æœ›

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Step 3: é£é™©è¯„ä¼° (Risk Assessment)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

å½“å‰è´¦æˆ·çŠ¶æ€ï¼š
- å‡€å€¼ï¼š$10,453 (BTCå¹³ä»“å)
- å¯ç”¨ä½™é¢ï¼š$10,453
- å½“å‰æŒä»“ï¼š0
- é£é™©æ•å£ï¼š0%

ETHå¼€ä»“é£é™©è®¡ç®—ï¼š
- è®¡åˆ’ä»“ä½ï¼š$2,000 (20%èµ„é‡‘)
- æ æ†ï¼š3x
- æ­¢æŸï¼š$3,000 (-4.5%)
- æœ€å¤§äºæŸï¼š$2,000 Ã— 3 Ã— 4.5% = $270 (2.6%èµ„é‡‘)
- é£é™©è¯„ä¼°ï¼šâœ… å¯æ¥å—ï¼ˆå•ç¬”é£é™©<3%ï¼‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Step 4: ç»¼åˆå†³ç­– (Final Decision)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ä¼˜å…ˆçº§1 - å¤„ç†ç°æœ‰æŒä»“ï¼š
âœ… å¹³ä»“BTC (+5.2%, $453åˆ©æ¶¦)

ä¼˜å…ˆçº§2 - å¼€æ–°ä»“ä½ï¼š
âœ… å¼€å¤šETH (ä¿¡å·å¼ºï¼Œé£é™©å¯æ§)

ä¼˜å…ˆçº§3 - æŒæœ‰/ç­‰å¾…ï¼š
- SOLæš‚æ—¶è§‚æœ›

æœ€ç»ˆæ‰§è¡Œï¼š
1. close_long BTC
2. open_long ETH

</reasoning>

<decision>
[
  {
    "symbol": "BTCUSDT",
    "action": "close_long",
    "leverage": 1,
    "quantity": 0.5,
    "stop_loss": 0,
    "take_profit": 0,
    "confidence": 0.9,
    "risk_usd": 0,
    "reasoning": "æ­¢ç›ˆå¹³ä»“ï¼Œé”å®š+5.2%åˆ©æ¶¦"
  },
  {
    "symbol": "ETHUSDT",
    "action": "open_long",
    "leverage": 3,
    "quantity": 0.19,
    "stop_loss": 3000,
    "take_profit": 3300,
    "confidence": 0.75,
    "risk_usd": 270,
    "reasoning": "4Hè¶‹åŠ¿è½¬å¤šï¼ŒMACDé‡‘å‰ï¼Œæˆäº¤é‡ç¡®è®¤"
  }
]
</decision>
```

---

## ğŸ“¨ å¸‚åœºPromptæ ¼å¼è¯¦è§£

Green Agentåœ¨æ¯ä¸ªäº¤æ˜“å‘¨æœŸä¼šä¸ºæ¯ä¸ªWhite Agentæ„å»ºä¸ªæ€§åŒ–çš„å¸‚åœºpromptï¼ŒåŒ…å«ï¼š

### 0. System Promptï¼ˆåŸºç¡€æŒ‡ä»¤ï¼‰

Green Agentä¼šåœ¨æ¯æ¬¡å‘é€ç»™White Agentçš„promptä¸­åŒ…å«system promptï¼Œæ˜ç¡®å†³ç­–æµç¨‹ï¼š

```
ä½ æ˜¯ä¸“ä¸šçš„åŠ å¯†è´§å¸äº¤æ˜“AIï¼Œåœ¨åˆçº¦å¸‚åœºè¿›è¡Œè‡ªä¸»äº¤æ˜“ã€‚

# æ ¸å¿ƒç›®æ ‡
æœ€å¤§åŒ–å¤æ™®æ¯”ç‡ï¼ˆSharpe Ratioï¼‰
å¤æ™®æ¯”ç‡ = å¹³å‡æ”¶ç›Š / æ”¶ç›Šæ³¢åŠ¨ç‡

è¿™æ„å‘³ç€ï¼š
- é«˜è´¨é‡äº¤æ˜“ï¼ˆé«˜èƒœç‡ã€å¤§ç›ˆäºæ¯”ï¼‰â†’ æå‡å¤æ™®
- ç¨³å®šæ”¶ç›Šã€æ§åˆ¶å›æ’¤ â†’ æå‡å¤æ™®
- è€å¿ƒæŒä»“ã€è®©åˆ©æ¶¦å¥”è·‘ â†’ æå‡å¤æ™®
- é¢‘ç¹äº¤æ˜“ã€å°ç›ˆå°äº â†’ å¢åŠ æ³¢åŠ¨ï¼Œä¸¥é‡é™ä½å¤æ™®

å…³é”®è®¤çŸ¥ï¼šç³»ç»Ÿæ¯4å°æ—¶å†³ç­–ä¸€æ¬¡ï¼Œä½†ä¸æ„å‘³ç€æ¯æ¬¡éƒ½è¦äº¤æ˜“ï¼
å¤§å¤šæ•°æ—¶å€™åº”è¯¥æ˜¯ `wait` æˆ– `hold`ï¼Œåªåœ¨æä½³æœºä¼šæ—¶æ‰å¼€ä»“ã€‚

# ğŸ“‹ å†³ç­–æµç¨‹ï¼ˆDECISION PROCESS - å¿…é¡»ä¸¥æ ¼éµå¾ªï¼‰

Step 1: æ£€æŸ¥ç°æœ‰æŒä»“ (Check Positions)
   - éå†å½“å‰æŒä»“åˆ—è¡¨
   - æ£€æŸ¥æ¯ä¸ªæŒä»“çš„ç›ˆäºæƒ…å†µ
   - åˆ¤æ–­æ˜¯å¦è§¦å‘æ­¢ç›ˆï¼šç›ˆåˆ©è¾¾åˆ°ç›®æ ‡ or å›æ’¤è¶…è¿‡é˜ˆå€¼
   - åˆ¤æ–­æ˜¯å¦è§¦å‘æ­¢æŸï¼šäºæŸè¾¾åˆ°æ­¢æŸç‚¹ or è¶‹åŠ¿åè½¬
   - è¾“å‡ºï¼šå¯¹ç°æœ‰æŒä»“çš„æ“ä½œå†³ç­–

Step 2: æ‰«æå€™é€‰å¸ç§ (Scan Candidates + Multi-Timeframe)
   - éå†æ‰€æœ‰å€™é€‰å¸ç§ï¼ˆBTC/ETH/SOLï¼‰
   - å¤šæ—¶é—´æ¡†æ¶åˆ†æï¼š
     * 4å°æ—¶çº§åˆ«ï¼šåˆ¤æ–­ä¸»è¶‹åŠ¿æ–¹å‘
     * 3åˆ†é’Ÿçº§åˆ«ï¼šå¯»æ‰¾å…¥åœºæ—¶æœº
   - æ£€æŸ¥æ˜¯å¦å­˜åœ¨å¼ºä¿¡å·ï¼š
     * è¶‹åŠ¿ä¿¡å·ï¼šEMAäº¤å‰ã€MACDé‡‘å‰/æ­»å‰
     * åŠ¨é‡ä¿¡å·ï¼šRSIçªç ´ã€æˆäº¤é‡ç¡®è®¤
     * å½¢æ€ä¿¡å·ï¼šçªç ´å…³é”®ä»·ä½
   - è¾“å‡ºï¼šæ½œåœ¨çš„æ–°å¼€ä»“æœºä¼š

Step 3: é£é™©è¯„ä¼° (Risk Assessment)
   - å½“å‰è´¦æˆ·é£é™©æ•å£
   - æ–°å¼€ä»“æ˜¯å¦ä¼šå¯¼è‡´è¿‡åº¦æ æ†
   - å¸‚åœºæ³¢åŠ¨ç‡è¯„ä¼°ï¼ˆATRï¼‰
   - è¾“å‡ºï¼šæ˜¯å¦å…è®¸æ–°å¼€ä»“

Step 4: ç»¼åˆå†³ç­– (Final Decision)
   - ä¼˜å…ˆçº§1ï¼šå¤„ç†ç°æœ‰æŒä»“ï¼ˆæ­¢ç›ˆ/æ­¢æŸï¼‰
   - ä¼˜å…ˆçº§2ï¼šå¼€æ–°ä»“ä½ï¼ˆå¦‚æœé£é™©å…è®¸ï¼‰
   - ä¼˜å…ˆçº§3ï¼šæŒæœ‰æˆ–ç­‰å¾…ï¼ˆå¦‚æœæ— æ˜ç¡®ä¿¡å·ï¼‰
   - è¾“å‡ºï¼šæœ€ç»ˆåŠ¨ä½œåˆ—è¡¨

Step 5: ç»“æ„åŒ–è¾“å‡º (Write Chain of Thought First, Then JSON)
   - å…ˆå†™ <summary>ï¼šä¸€å¥è¯æ€»ç»“å†³ç­–
   - å†å†™ <reasoning>ï¼šå®Œæ•´çš„æ€ç»´é“¾ï¼ˆå¿…é¡»åŒ…å«Step 1-4çš„åˆ†æï¼‰
   - æœ€åå†™ <decision>ï¼šJSONæ ¼å¼çš„åŠ¨ä½œ

# è¾“å‡ºæ ¼å¼ï¼ˆä¸¥æ ¼éµå®ˆï¼‰

<summary>
ä¸€å¥è¯æ€»ç»“ä½ çš„å†³ç­–å’Œç†ç”±
</summary>

<reasoning>
â”â”â” Step 1: æ£€æŸ¥ç°æœ‰æŒä»“ â”â”â”
[åˆ†ææ¯ä¸ªæŒä»“ï¼Œå†³å®šæ˜¯å¦æ­¢ç›ˆ/æ­¢æŸ]

â”â”â” Step 2: æ‰«æå€™é€‰å¸ç§ â”â”â”
[å¤šæ—¶é—´æ¡†æ¶åˆ†æï¼Œå¯»æ‰¾å¼ºä¿¡å·]

â”â”â” Step 3: é£é™©è¯„ä¼° â”â”â”
[è¯„ä¼°è´¦æˆ·é£é™©ï¼Œåˆ¤æ–­æ˜¯å¦å¯å¼€æ–°ä»“]

â”â”â” Step 4: ç»¼åˆå†³ç­– â”â”â”
[æœ€ç»ˆå†³ç­–é€»è¾‘]

[Round 2+è¿˜éœ€åŒ…å«ï¼šå¯¹æ‰‹åˆ†æã€ç­–ç•¥è°ƒæ•´]
</reasoning>

<decision>
[JSONæ•°ç»„ï¼ŒåŒ…å«æ‰€æœ‰åŠ¨ä½œ]
</decision>

ç°åœ¨ï¼Œåˆ†æä»¥ä¸‹å¸‚åœºæ•°æ®å¹¶åšå‡ºå†³ç­–ï¼š
```

---

### 1. è´¦æˆ·çŠ¶æ€è¯»å–

```python
# Green Agentä»BacktestAccountè¯»å–è¯¥agentçš„çŠ¶æ€
account = self.accounts[agent_name]  # æ¯ä¸ªagentæœ‰ç‹¬ç«‹è´¦æˆ·

è´¦æˆ·ä¿¡æ¯:
â”œâ”€ ç°é‡‘ä½™é¢: account.cash
â”œâ”€ æŒä»“åˆ—è¡¨: account.positions (dict)
â”œâ”€ æ€»å‡€å€¼: account.total_equity(current_prices)
â””â”€ ç›ˆäºç™¾åˆ†æ¯”: (å‡€å€¼ - åˆå§‹èµ„é‡‘) / åˆå§‹èµ„é‡‘ Ã— 100%
```

### 2. æŒä»“ä¿¡æ¯æ ¼å¼åŒ–

```
## å½“å‰æŒä»“

1. BTCUSDT LONG | å…¥åœºä»·87234.50 å½“å‰ä»·89105.20 | æ•°é‡0.05 | ä»“ä½ä»·å€¼4455.26 USDT | ç›ˆäº+2.15% | ç›ˆäºé‡‘é¢+93.53 USDT | æ æ†5x | å¼ºå¹³ä»·69787.60

current_price = 89105.20, current_ema20 = 88500.30, current_macd = 0.2541, current_rsi (7 period) = 65.23

Intraday series (æœ€è¿‘10ä¸ªå‘¨æœŸ, æ—§â†’æ–°):
Mid prices: [87234.50, 87456.20, 88012.30, 88543.10, 88234.50, 88789.20, 89012.40, 88965.30, 89023.10, 89105.20]
EMA indicators (20-period): [87123.45, 87345.67, 87654.32, 87932.10, 88123.45, 88345.67, 88567.89, 88712.34, 88834.56, 88500.30]
MACD indicators: [0.1234, 0.1456, 0.1789, 0.2012, 0.2234, 0.2345, 0.2456, 0.2512, 0.2534, 0.2541]
RSI indicators (7-Period): [58.23, 59.45, 61.23, 63.45, 64.12, 64.89, 65.01, 65.12, 65.18, 65.23]
RSI indicators (14-Period): [55.67, 56.89, 58.23, 59.45, 60.12, 60.78, 61.23, 61.45, 61.67, 61.89]
Volume: [1523456, 1634567, 1745678, 1856789, 1967890, 2078901, 2189012, 2290123, 2301234, 2412345]
ATR (14-period): 1234.56
```

**å…³é”®ç‚¹ï¼š**
- âœ… Green Agentä»agentçš„BacktestAccountè¯»å–æŒä»“
- âœ… åŒ…å«æœªå®ç°ç›ˆäºè®¡ç®—
- âœ… åŒ…å«è¯¥æŒä»“å¸ç§çš„å®Œæ•´æŠ€æœ¯æŒ‡æ ‡
- âœ… å¦‚æœæ— æŒä»“ï¼Œæ˜¾ç¤º"æ— æŒä»“"

### 3. å€™é€‰å¸ç§æä¾›

```
## å€™é€‰å¸ç§ (3ä¸ª)

### 1. BTCUSDT
current_price = 89105.20, current_ema20 = 88500.30, current_macd = 0.2541, current_rsi (7 period) = 65.23

Intraday series (æœ€è¿‘10ä¸ªå‘¨æœŸ):
Mid prices: [87234.50, 87456.20, 88012.30, 88543.10, 88234.50, 88789.20, 89012.40, 88965.30, 89023.10, 89105.20]
EMA indicators (20-period): [87123.45, 87345.67, ...]
MACD indicators: [0.1234, 0.1456, ...]
RSI indicators (7-Period): [58.23, 59.45, ...]
RSI indicators (14-Period): [55.67, 56.89, ...]
Volume: [1523456, 1634567, ...]
ATR (14-period): 1234.56

### 2. ETHUSDT
current_price = 3142.50, current_ema20 = 3100.20, current_macd = 0.1523, current_rsi (7 period) = 58.45

Intraday series (æœ€è¿‘10ä¸ªå‘¨æœŸ):
Mid prices: [3089.20, 3095.40, 3102.30, 3108.50, 3115.20, 3120.40, 3128.60, 3135.80, 3139.20, 3142.50]
[... å®Œæ•´æŠ€æœ¯æŒ‡æ ‡ ...]

### 3. SOLUSDT
current_price = 218.45, current_ema20 = 215.30, current_macd = -0.0523, current_rsi (7 period) = 48.23

Intraday series (æœ€è¿‘10ä¸ªå‘¨æœŸ):
Mid prices: [215.20, 215.80, 216.30, 216.90, 217.20, 217.80, 218.10, 218.25, 218.35, 218.45]
[... å®Œæ•´æŠ€æœ¯æŒ‡æ ‡ ...]
```

**å€™é€‰å¸ç§é…ç½®ï¼š**
- åœ¨ `scenario.toml` ä¸­å®šä¹‰ï¼š`symbols = ["BTCUSDT", "ETHUSDT", "SOLUSDT"]`
- Green AgentåŠ è½½æ‰€æœ‰å€™é€‰å¸ç§çš„å†å²æ•°æ®
- æ¯ä¸ªå‘¨æœŸæä¾›æ‰€æœ‰å€™é€‰å¸çš„å®Œæ•´æŠ€æœ¯æŒ‡æ ‡
- White Agentså¯ä»¥é€‰æ‹©ä»»æ„å€™é€‰å¸è¿›è¡Œäº¤æ˜“

### 4. å®Œæ•´Promptç¤ºä¾‹

**Day 5æ—¶ï¼ŒConservativeTraderæ”¶åˆ°çš„å®Œæ•´promptï¼š**

```
æ—¶é—´: Day 5 | å‘¨æœŸ: #5 | è¿è¡Œ: 5å¤©

BTC: 89105.20 (1h: +1.2%, 4h: +2.8%) | MACD: 0.2541 | RSI: 65.23

è´¦æˆ·: å‡€å€¼9893.45 | ä½™é¢9800.00 (99.1%) | ç›ˆäº-1.07% | æŒä»“1ä¸ª

## å½“å‰æŒä»“ â­ è¯»å–è¯¥Agentçš„BacktestAccount

1. BTCUSDT LONG | å…¥åœºä»·87234.50 å½“å‰ä»·89105.20 | æ•°é‡0.05 | ä»“ä½ä»·å€¼4455.26 USDT | ç›ˆäº+2.15% | ç›ˆäºé‡‘é¢+93.53 USDT | æ æ†5x | ä¿è¯é‡‘891.05 | å¼ºå¹³ä»·69787.60 | æŒä»“æ—¶é•¿3å¤©

current_price = 89105.20, current_ema20 = 88500.30, current_macd = 0.2541, current_rsi (7 period) = 65.23

Intraday series (æœ€è¿‘10ä¸ªå‘¨æœŸ, æ—§â†’æ–°):
Mid prices: [87234.50, 87456.20, 88012.30, 88543.10, 88234.50, 88789.20, 89012.40, 88965.30, 89023.10, 89105.20]
EMA indicators (20-period): [87123.45, 87345.67, 87654.32, 87932.10, 88123.45, 88345.67, 88567.89, 88712.34, 88834.56, 88500.30]
MACD indicators: [0.1234, 0.1456, 0.1789, 0.2012, 0.2234, 0.2345, 0.2456, 0.2512, 0.2534, 0.2541]
RSI indicators (7-Period): [58.23, 59.45, 61.23, 63.45, 64.12, 64.89, 65.01, 65.12, 65.18, 65.23]
RSI indicators (14-Period): [55.67, 56.89, 58.23, 59.45, 60.12, 60.78, 61.23, 61.45, 61.67, 61.89]
Volume: [1523456, 1634567, 1745678, 1856789, 1967890, 2078901, 2189012, 2290123, 2301234, 2412345]
ATR (14-period): 1234.56

## å€™é€‰å¸ç§ (3ä¸ª) â­ æä¾›æ‰€æœ‰å¯äº¤æ˜“å¸ç§

### 1. BTCUSDT
current_price = 89105.20, current_ema20 = 88500.30, current_macd = 0.2541, current_rsi (7 period) = 65.23

Intraday series (æœ€è¿‘10ä¸ªå‘¨æœŸ):
Mid prices: [87234.50, 87456.20, 88012.30, 88543.10, 88234.50, 88789.20, 89012.40, 88965.30, 89023.10, 89105.20]
[... å®Œæ•´æŒ‡æ ‡ ...]

### 2. ETHUSDT
current_price = 3142.50, current_ema20 = 3100.20, current_macd = 0.1523, current_rsi (7 period) = 58.45

Intraday series (æœ€è¿‘10ä¸ªå‘¨æœŸ):
Mid prices: [3089.20, 3095.40, 3102.30, 3108.50, 3115.20, 3120.40, 3128.60, 3135.80, 3139.20, 3142.50]
[... å®Œæ•´æŒ‡æ ‡ ...]

### 3. SOLUSDT
current_price = 218.45, current_ema20 = 215.30, current_macd = -0.0523, current_rsi (7 period) = 48.23

Intraday series (æœ€è¿‘10ä¸ªå‘¨æœŸ):
Mid prices: [215.20, 215.80, 216.30, 216.90, 217.20, 217.80, 218.10, 218.25, 218.35, 218.45]
[... å®Œæ•´æŒ‡æ ‡ ...]

---

åŸºäºä»¥ä¸Šä¿¡æ¯ï¼Œåšå‡ºä½ çš„äº¤æ˜“å†³ç­–ã€‚
```

**ConservativeTraderçš„å†³ç­–è€ƒè™‘ï¼š**
- æˆ‘æœ‰BTCå¤šå¤´æŒä»“ï¼ˆ+2.15%ç›ˆåˆ©ï¼‰
- BTCä»åœ¨ä¸Šæ¶¨ï¼ˆä»·æ ¼ > EMA20ï¼‰
- RSI=65ç•¥é«˜ä½†æœªè¶…ä¹°
- å¯é€‰æ‹©ï¼šæŒæœ‰BTCã€åŠ ä»“BTCã€å¹³ä»“æ­¢ç›ˆã€æˆ–å¼€ä»“å…¶ä»–å¸ç§ï¼ˆETH/SOLï¼‰

  
  3. å¹¶è¡Œå‘é€ç»™æ‰€æœ‰Agents (A2Aé€šä¿¡)
     ConservativeTrader â† Promptï¼ˆå«å…¶BTCæŒä»“ï¼‰
     BalancedTrader â† Promptï¼ˆå«å…¶è´¦æˆ·çŠ¶æ€ï¼‰
     AggressiveTrader â† Promptï¼ˆå«å…¶è´¦æˆ·çŠ¶æ€ï¼‰
     MomentumTrader â† Promptï¼ˆå«å…¶è´¦æˆ·çŠ¶æ€ï¼‰
     MeanReversionTrader â† Promptï¼ˆå«å…¶è´¦æˆ·çŠ¶æ€ï¼‰

```python
# 1. äº¤æ˜“å†³ç­–ï¼ˆWhite Agentè¾“å‡ºï¼‰
class TradingAction(BaseModel):
    symbol: str
    action: Literal["open_long", "open_short", "close_long", "close_short", "hold", "wait"]
    leverage: int = 1
    quantity: float = 0
    stop_loss: Optional[float] = None
    take_profit: Optional[float] = None
    confidence: float = 0.5
    risk_usd: float = 0
    reasoning: str

class TradingDecision(BaseModel):
    summary: str
    reasoning: str
    actions: List[TradingAction]

# 2. å¤šè½®äº¤äº’æ¨¡å‹ â­ æ–°å¢
class AgentRoundDecision(BaseModel):
    """å•ä¸ªagentåœ¨ä¸€ä¸ªroundçš„å®Œæ•´è®°å½•"""
    agent_name: str
    day: int
    round: int
    
    # å¸‚åœºè§‚ç‚¹ï¼ˆä»reasoningä¸­æå–ï¼‰
    market_view: str              # "BTCçªç ´$90kï¼Œè¶‹åŠ¿å¼ºåŠ²"
    
    # å¯¹æ‰‹åˆ†æï¼ˆRound 2+æ‰ä¼šæœ‰ï¼‰
    opponent_analysis: Optional[Dict[str, str]] = None
    # {"MomentumTrader": "åˆ¤æ–­æ­£ç¡®ï¼Œå¯è·Ÿéš", "MeanReversionTrader": "é€†åŠ¿å¤±è´¥"}
    
    # ç­–ç•¥è°ƒæ•´ï¼ˆRound 2+æ‰ä¼šæœ‰ï¼‰
    strategy_adjustment: Optional[str] = None
    # "å¢åŠ è¶‹åŠ¿è·Ÿéšæƒé‡ï¼Œé™ä½æ æ†"
    
    # æ‰§è¡Œçš„åŠ¨ä½œ
    actions: List[TradingAction]
    
    # å®Œæ•´çš„æ¨ç†è¿‡ç¨‹
    full_reasoning: str

class DisclosurePackage(BaseModel):
    """æŠ«éœ²ç‚¹æ•°æ®åŒ…"""
    round_number: int              # ç¬¬å‡ è½® (1, 2, 3)
    disclosure_day: int            # ç¬¬å‡ å¤© (7, 14, 21)
    
    # æ’è¡Œæ¦œ
    leaderboard: List[Dict]        # [{"rank": 1, "name": "T1", "pnl_pct": 15.2, "equity": 11520}]
    
    # æ¯ä¸ªagentçš„è¯¥è½®è¡¨ç°
    agents_round_summary: List[Dict]  # åŒ…å«reasoningã€positionsã€actionsç­‰

class IntelligenceReport(BaseModel):
    """å‘é€ç»™agentçš„æƒ…æŠ¥æŠ¥å‘Š"""
    opponent_name: str
    current_rank: int
    current_pnl_pct: float
    current_positions: str         # "BTC 0.5 Long @ $87,876"
    
    # è¯¥å¯¹æ‰‹çš„å†å²å†³ç­–æ‘˜è¦
    recent_market_views: List[str]     # æœ€è¿‘3æ¬¡çš„å¸‚åœºè§‚ç‚¹
    recent_actions_summary: str        # "Day 2å¼€å¤š0.3 BTC, Day 5åŠ ä»“0.2"
    strategy_pattern: str              # "è¶‹åŠ¿è·Ÿéšå‹ï¼Œå¿«é€Ÿå“åº”"
    success_rate: str                  # "3/5æˆåŠŸ" 

# 3. LLMè¯„ä¼°æ¨¡å‹ â­ æ–°å¢ï¼ˆå‚è€ƒdebate judgeï¼‰
class ReasoningEvaluation(BaseModel):
    """å•æ¬¡å†³ç­–çš„reasoningè´¨é‡è¯„ä¼°"""
    agent_name: str
    cycle_idx: int
    timestamp: str
    
    # è¯„ä¼°ç»´åº¦ï¼ˆ0-1åˆ†ï¼‰
    decision_process_adherence: float   # Decision Processéµå¾ªåº¦
    # æ˜¯å¦æŒ‰ç…§Step 1-5çš„æµç¨‹åˆ†æ
    
    technical_analysis_accuracy: float  # æŠ€æœ¯åˆ†æå‡†ç¡®æ€§
    # æŠ€æœ¯æŒ‡æ ‡è§£è¯»æ˜¯å¦æ­£ç¡®ï¼ˆEMA/MACD/RSIç­‰ï¼‰
    
    risk_assessment_quality: float      # é£é™©è¯„ä¼°åˆç†æ€§
    # æ˜¯å¦å……åˆ†è¯„ä¼°é£é™©ã€æ­¢æŸè®¾ç½®æ˜¯å¦åˆç†
    
    logical_consistency: float          # é€»è¾‘ä¸€è‡´æ€§
    # reasoningå’Œdecisionæ˜¯å¦ä¸€è‡´
    
    multi_timeframe_quality: float      # å¤šæ—¶é—´æ¡†æ¶åˆ†æè´¨é‡
    # 4Hå’Œ3Måˆ†ææ˜¯å¦éƒ½æœ‰æ•ˆåˆ©ç”¨
    
    # ç»¼åˆè¯„åˆ†
    overall_score: float                # å¹³å‡åˆ†
    
    # LLMè¯„è¯­
    strengths: str                      # ä¼˜ç‚¹
    weaknesses: str                     # ä¸è¶³
    suggestions: str                    # æ”¹è¿›å»ºè®®

class AgentReasoningQuality(BaseModel):
    """Agentçš„æ•´ä½“reasoningè´¨é‡ï¼ˆ180æ¬¡å†³ç­–çš„å¹³å‡ï¼‰"""
    agent_name: str
    total_evaluations: int              # 180æ¬¡
    
    # å¹³å‡åˆ†æ•°
    avg_decision_process: float
    avg_technical_analysis: float
    avg_risk_assessment: float
    avg_logical_consistency: float
    avg_multi_timeframe: float
    
    # æ€»ä½“reasoningåˆ†æ•°
    overall_reasoning_score: float      # å¹³å‡åˆ†
    
    # åˆ†å¸ƒç»Ÿè®¡
    excellent_count: int                # >0.8åˆ†çš„å†³ç­–æ•°
    good_count: int                     # 0.6-0.8çš„å†³ç­–æ•°
    poor_count: int                     # <0.6çš„å†³ç­–æ•°

# 4. ç»©æ•ˆè¯„ä¼°ï¼ˆGreen Agentè¾“å‡ºï¼‰
class AgentPerformance(BaseModel):
    agent_name: str
    strategy: str
    
    # Return Metrics
    total_return_pct: float
    total_return_usd: float
    cagr: float
    
    # Risk Metrics â­
    sharpe_ratio: float           # æ ¸å¿ƒæŒ‡æ ‡
    max_drawdown_pct: float
    volatility: float
    sortino_ratio: float
    
    # Trading Metrics â­
    total_trades: int             # äº¤æ˜“æ¬¡æ•°
    win_rate: float
    profit_factor: float
    avg_trades_per_day: float
    
    # Reasoning Quality â­ æ–°å¢
    reasoning_quality: AgentReasoningQuality
    
    # Scoring (0-1)
    profitability_score: float
    risk_management_score: float
    consistency_score: float
    efficiency_score: float
    robustness_score: float
    reasoning_score: float        # â­ æ–°å¢ï¼šreasoningè´¨é‡åˆ†æ•°
    
    # æœ€ç»ˆå¾—åˆ† â­ ä¿®æ”¹æƒé‡
    total_score: float            # äº¤æ˜“ç»©æ•ˆ(70%) + Reasoningè´¨é‡(30%)
```

---

## ğŸ¤– LLMè¯„ä¼°Reasoningè´¨é‡ï¼ˆå‚è€ƒDebate Judgeï¼‰

### ä¸ºä»€ä¹ˆéœ€è¦LLMè¯„ä¼°ï¼Ÿ

**é—®é¢˜**ï¼šçº¯è®¡ç®—æŒ‡æ ‡ï¼ˆSharpeã€å›æ’¤ç­‰ï¼‰åªèƒ½è¯„ä¼°**ç»“æœ**ï¼Œæ— æ³•è¯„ä¼°**è¿‡ç¨‹**
- âŒ æ— æ³•åˆ¤æ–­å†³ç­–æ¨ç†æ˜¯å¦åˆç†
- âŒ æ— æ³•è¯†åˆ«"è¿æ°”å¥½"vs"åˆ†æå‡†"
- âŒ æ— æ³•è¯„ä¼°Decision Processçš„æ‰§è¡Œè´¨é‡
- âŒ æ— æ³•ç»™å‡ºæ”¹è¿›å»ºè®®

**è§£å†³**ï¼šå¼•å…¥LLMä½œä¸ºJudgeï¼Œè¯„ä¼°æ¯æ¬¡å†³ç­–çš„reasoningè´¨é‡

### è¯„ä¼°ç»´åº¦ï¼ˆå‚è€ƒDebate Judgeçš„4ç»´åº¦è¯„åˆ†ï¼‰

ç±»ä¼¼Debate Judgeè¯„ä¼°"Emotional Appeal, Clarity, Logic, Relevance"ï¼Œæˆ‘ä»¬è¯„ä¼°ï¼š

```python
class ReasoningEvaluation(BaseModel):
    """æ¯æ¬¡å†³ç­–çš„reasoningè´¨é‡è¯„ä¼°ï¼ˆ0-1åˆ†ï¼‰"""
    
    # 1. Decision Processéµå¾ªåº¦ï¼ˆ0-1ï¼‰
    decision_process_adherence: float
    # - æ˜¯å¦æŒ‰Step 1-5åˆ†æï¼Ÿ
    # - æ˜¯å¦å…ˆæ£€æŸ¥æŒä»“ï¼Œå†æ‰«æå€™é€‰å¸ï¼Ÿ
    # - æ˜¯å¦åŒ…å«é£é™©è¯„ä¼°ï¼Ÿ
    
    # 2. æŠ€æœ¯åˆ†æå‡†ç¡®æ€§ï¼ˆ0-1ï¼‰
    technical_analysis_accuracy: float
    # - EMA/MACD/RSIè§£è¯»æ˜¯å¦æ­£ç¡®ï¼Ÿ
    # - æ˜¯å¦æ­£ç¡®åˆ¤æ–­è¶‹åŠ¿ï¼Ÿ
    # - æ˜¯å¦æœ‰æ•ˆåˆ©ç”¨3åˆ†é’Ÿå’Œ4å°æ—¶æ•°æ®ï¼Ÿ
    
    # 3. é£é™©è¯„ä¼°åˆç†æ€§ï¼ˆ0-1ï¼‰
    risk_assessment_quality: float
    # - æ æ†é€‰æ‹©æ˜¯å¦åˆç†ï¼Ÿ
    # - æ­¢æŸä½ç½®æ˜¯å¦åˆç†ï¼Ÿ
    # - ä»“ä½å¤§å°æ˜¯å¦åŒ¹é…é£é™©ï¼Ÿ
    
    # 4. é€»è¾‘ä¸€è‡´æ€§ï¼ˆ0-1ï¼‰
    logical_consistency: float
    # - reasoningå’Œdecisionæ˜¯å¦ä¸€è‡´ï¼Ÿ
    # - ç»“è®ºæ˜¯å¦ä»åˆ†æä¸­åˆç†æ¨å¯¼ï¼Ÿ
    # - æ˜¯å¦æœ‰è‡ªç›¸çŸ›ç›¾ï¼Ÿ
    
    # 5. å¤šæ—¶é—´æ¡†æ¶åˆ†æè´¨é‡ï¼ˆ0-1ï¼‰
    multi_timeframe_quality: float
    # - 4Hè¶‹åŠ¿åˆ¤æ–­æ˜¯å¦å‡†ç¡®ï¼Ÿ
    # - 3Må…¥åœºæ—¶æœºé€‰æ‹©æ˜¯å¦åˆç†ï¼Ÿ
    # - ä¸¤ä¸ªæ—¶é—´æ¡†æ¶æ˜¯å¦ååŒï¼Ÿ
    
    # ç»¼åˆåˆ†æ•°
    overall_score: float  # 5ä¸ªç»´åº¦çš„å¹³å‡å€¼
    
    # LLMè¯„è¯­
    strengths: str       # "æŠ€æœ¯åˆ†ææ‰å®ï¼Œé£é™©æ§åˆ¶ä¸¥æ ¼"
    weaknesses: str      # "æœªå……åˆ†åˆ©ç”¨3åˆ†é’Ÿæ•°æ®"
    suggestions: str     # "å»ºè®®åŠ å¼ºå¯¹æˆäº¤é‡çš„å…³æ³¨"
```

### LLMè¯„ä¼°Promptè®¾è®¡

```python
async def evaluate_reasoning(
    self,
    agent_name: str,
    decision: TradingDecision,
    market_context: Dict,
    cycle_idx: int
) -> ReasoningEvaluation:
    """ä½¿ç”¨LLMè¯„ä¼°reasoningè´¨é‡ï¼ˆç±»ä¼¼debate judgeï¼‰"""
    
    system_prompt = """
ä½ æ˜¯ä¸€ä½ç»éªŒä¸°å¯Œçš„äº¤æ˜“å¯¼å¸ˆå’Œè¯„å®¡ï¼Œè´Ÿè´£è¯„ä¼°AIäº¤æ˜“agentçš„å†³ç­–reasoningè´¨é‡ã€‚

ä½ å°†åŸºäº5ä¸ªç»´åº¦å¯¹reasoningè¿›è¡Œè¯„åˆ†ï¼ˆæ¯ä¸ªç»´åº¦0-1åˆ†ï¼‰ï¼š

1. **Decision Process Adherenceï¼ˆå†³ç­–æµç¨‹éµå¾ªåº¦ï¼‰**
   - æ˜¯å¦æŒ‰ç…§è§„å®šçš„5æ­¥æµç¨‹åˆ†æï¼Ÿ
     * Step 1: æ£€æŸ¥ç°æœ‰æŒä»“
     * Step 2: æ‰«æå€™é€‰å¸ç§ï¼ˆå¤šæ—¶é—´æ¡†æ¶ï¼‰
     * Step 3: é£é™©è¯„ä¼°
     * Step 4: ç»¼åˆå†³ç­–
     * Step 5: ç»“æ„åŒ–è¾“å‡º
   - 0åˆ†ï¼šå®Œå…¨æ²¡æœ‰ç»“æ„ï¼Œéšæ„åˆ†æ
   - 1åˆ†ï¼šä¸¥æ ¼æŒ‰ç…§æµç¨‹ï¼Œæ¯ä¸€æ­¥éƒ½æ¸…æ™°

2. **Technical Analysis Accuracyï¼ˆæŠ€æœ¯åˆ†æå‡†ç¡®æ€§ï¼‰**
   - æŠ€æœ¯æŒ‡æ ‡è§£è¯»æ˜¯å¦æ­£ç¡®ï¼Ÿï¼ˆEMA, MACD, RSI, ATRç­‰ï¼‰
   - è¶‹åŠ¿åˆ¤æ–­æ˜¯å¦åˆç†ï¼Ÿ
   - æ˜¯å¦æœ‰æ•ˆåˆ©ç”¨äº†4å°æ—¶å’Œ3åˆ†é’Ÿæ•°æ®ï¼Ÿ
   - 0åˆ†ï¼šæŠ€æœ¯åˆ†æå®Œå…¨é”™è¯¯æˆ–ç¼ºå¤±
   - 1åˆ†ï¼šæŠ€æœ¯åˆ†æç²¾å‡†ï¼ŒæŒ‡æ ‡è¿ç”¨å¾—å½“

3. **Risk Assessment Qualityï¼ˆé£é™©è¯„ä¼°åˆç†æ€§ï¼‰**
   - æ æ†é€‰æ‹©æ˜¯å¦é€‚åˆå½“å‰å¸‚åœºå’Œç­–ç•¥ï¼Ÿ
   - æ­¢æŸä½ç½®æ˜¯å¦åˆç†ï¼Ÿ
   - ä»“ä½å¤§å°æ˜¯å¦åŒ¹é…é£é™©æ‰¿å—èƒ½åŠ›ï¼Ÿ
   - æ˜¯å¦è€ƒè™‘äº†è´¦æˆ·æ•´ä½“é£é™©æ•å£ï¼Ÿ
   - 0åˆ†ï¼šæ— é£é™©è¯„ä¼°æˆ–é£é™©ç®¡ç†æ··ä¹±
   - 1åˆ†ï¼šé£é™©è¯„ä¼°å…¨é¢ï¼Œå‚æ•°è®¾ç½®åˆç†

4. **Logical Consistencyï¼ˆé€»è¾‘ä¸€è‡´æ€§ï¼‰**
   - reasoningä¸­çš„åˆ†æå’Œæœ€ç»ˆdecisionæ˜¯å¦ä¸€è‡´ï¼Ÿ
   - ç»“è®ºæ˜¯å¦ä»åˆ†æä¸­åˆç†æ¨å¯¼ï¼Ÿ
   - æ˜¯å¦æœ‰è‡ªç›¸çŸ›ç›¾ä¹‹å¤„ï¼Ÿ
   - 0åˆ†ï¼šé€»è¾‘æ··ä¹±ï¼Œå‰åçŸ›ç›¾
   - 1åˆ†ï¼šé€»è¾‘ä¸¥å¯†ï¼Œæ¨å¯¼åˆç†

5. **Multi-Timeframe Analysis Qualityï¼ˆå¤šæ—¶é—´æ¡†æ¶åˆ†æè´¨é‡ï¼‰**
   - 4å°æ—¶çº§åˆ«çš„è¶‹åŠ¿åˆ¤æ–­æ˜¯å¦å‡†ç¡®ï¼Ÿ
   - 3åˆ†é’Ÿçº§åˆ«çš„å…¥åœºæ—¶æœºé€‰æ‹©æ˜¯å¦åˆç†ï¼Ÿ
   - ä¸¤ä¸ªæ—¶é—´æ¡†æ¶æ˜¯å¦æœ‰æ•ˆååŒï¼Ÿ
   - 0åˆ†ï¼šåªçœ‹ä¸€ä¸ªæ—¶é—´æ¡†æ¶æˆ–ä¸¤è€…å†²çª
   - 1åˆ†ï¼šå¤šæ—¶é—´æ¡†æ¶å®Œç¾é…åˆ

è¾“å‡ºJSONæ ¼å¼ï¼ŒåŒ…å«ï¼š
- 5ä¸ªç»´åº¦çš„åˆ†æ•°
- overall_scoreï¼ˆ5ä¸ªç»´åº¦çš„å¹³å‡å€¼ï¼‰
- strengthsï¼ˆä¼˜ç‚¹ï¼‰
- weaknessesï¼ˆä¸è¶³ï¼‰
- suggestionsï¼ˆæ”¹è¿›å»ºè®®ï¼‰
"""

    user_prompt = f"""
è¯·è¯„ä¼°ä»¥ä¸‹trading agentçš„å†³ç­–reasoningè´¨é‡ï¼š

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Agentä¿¡æ¯
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Agentåç§°ï¼š{agent_name}
å†³ç­–å‘¨æœŸï¼š#{cycle_idx}
æ—¶é—´ï¼š{market_context['timestamp']}
ç­–ç•¥ï¼š{market_context['strategy']}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
å¸‚åœºä¸Šä¸‹æ–‡
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
{self._format_market_context(market_context)}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Agentçš„Reasoning
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
{decision.reasoning}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Agentçš„Decision
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
{json.dumps([a.dict() for a in decision.actions], indent=2)}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

åŸºäºä»¥ä¸Šä¿¡æ¯ï¼Œè¯·å¯¹è¯¥agentçš„reasoningè´¨é‡è¿›è¡Œå…¨é¢è¯„ä¼°ã€‚
"""

    # ä½¿ç”¨Gemini APIè¯„ä¼°ï¼ˆç±»ä¼¼debate judgeï¼‰
    response = self._client.models.generate_content(
        model="gemini-2.0-flash-exp",
        config=genai.types.GenerateContentConfig(
            system_instruction=system_prompt,
            response_mime_type="application/json",
            response_schema=ReasoningEvaluation,
        ),
        contents=user_prompt,
    )
    
    evaluation = response.parsed
    
    # è®°å½•è¯„ä¼°ç»“æœ
    logger.info(f"Reasoning Evaluation for {agent_name} (cycle #{cycle_idx}):")
    logger.info(f"  Overall Score: {evaluation.overall_score:.2f}")
    logger.info(f"  Strengths: {evaluation.strengths}")
    logger.info(f"  Weaknesses: {evaluation.weaknesses}")
    
    return evaluation
```

### åœ¨ä¸»å¾ªç¯ä¸­é›†æˆLLMè¯„ä¼°

```python
async def run_competition(self):
    """ä¸»ç«èµ›å¾ªç¯ï¼š180ä¸ªå†³ç­–å‘¨æœŸ"""
    
    all_evaluations: Dict[str, List[ReasoningEvaluation]] = {
        agent: [] for agent in self.agent_names
    }
    
    for cycle_idx, timestamp in enumerate(timestamps, 1):
        print(f"\nå†³ç­–å‘¨æœŸ #{cycle_idx}/180")
        
        for agent_name in self.agent_names:
            # 1. æ„å»ºprompt
            prompt = self.build_market_prompt(agent_name, cycle_idx, timestamp)
            
            # 2. è·å–agentå†³ç­–
            decision = await self.get_agent_decision(agent_name, prompt)
            
            # 3. â­ LLMè¯„ä¼°reasoningè´¨é‡
            market_context = {
                'timestamp': timestamp,
                'strategy': self.agent_strategies[agent_name],
                'current_price': self.current_prices,
                'account_state': self.accounts[agent_name].get_state()
            }
            evaluation = await self.evaluate_reasoning(
                agent_name, decision, market_context, cycle_idx
            )
            all_evaluations[agent_name].append(evaluation)
            
            # 4. å­˜å‚¨å†³ç­–
            self.store_round_decision(agent_name, cycle_idx, decision)
            
            # 5. æ‰§è¡Œäº¤æ˜“
            self.execute_decision(agent_name, decision, timestamp)
    
    # ç«èµ›ç»“æŸåï¼Œè®¡ç®—æ•´ä½“reasoningè´¨é‡
    for agent_name in self.agent_names:
        reasoning_quality = self._calculate_overall_reasoning_quality(
            all_evaluations[agent_name]
        )
        # ä¿å­˜åˆ°agentçš„performanceä¸­
        self.agent_performances[agent_name].reasoning_quality = reasoning_quality
```

### æœ€ç»ˆè¯„åˆ†å…¬å¼ï¼ˆæ–°å¢reasoningæƒé‡ï¼‰

```python
def calculate_final_score(self, performance: AgentPerformance) -> float:
    """è®¡ç®—æœ€ç»ˆå¾—åˆ†ï¼šäº¤æ˜“ç»©æ•ˆ(70%) + Reasoningè´¨é‡(30%)"""
    
    # äº¤æ˜“ç»©æ•ˆåˆ†æ•°ï¼ˆåŸæœ‰5ä¸ªç»´åº¦ï¼‰
    trading_score = (
        performance.profitability_score * 0.25 +        # ç›ˆåˆ©èƒ½åŠ› 25%
        performance.risk_management_score * 0.25 +      # é£é™©ç®¡ç† 25%
        performance.consistency_score * 0.20 +          # ä¸€è‡´æ€§ 20%
        performance.efficiency_score * 0.20 +           # æ•ˆç‡(Sharpe) 20%
        performance.robustness_score * 0.10             # ç¨³å¥æ€§ 10%
    )  # = 1.0
    
    # Reasoningè´¨é‡åˆ†æ•°ï¼ˆæ–°å¢ï¼‰
    reasoning_score = performance.reasoning_quality.overall_reasoning_score
    
    # æœ€ç»ˆå¾—åˆ†ï¼š70% äº¤æ˜“ç»©æ•ˆ + 30% Reasoningè´¨é‡
    final_score = trading_score * 0.7 + reasoning_score * 0.3
    
    return final_score

# ç¤ºä¾‹ï¼š
# Agent A: äº¤æ˜“ç»©æ•ˆ0.85, Reasoningè´¨é‡0.75 â†’ 0.85*0.7 + 0.75*0.3 = 0.82
# Agent B: äº¤æ˜“ç»©æ•ˆ0.90, Reasoningè´¨é‡0.60 â†’ 0.90*0.7 + 0.60*0.3 = 0.81
# â†’ Agent Aèƒœå‡ºï¼ˆreasoningè´¨é‡æ›´å¥½ï¼‰
```

### è¯„ä¼°é¢‘ç‡æ§åˆ¶ï¼ˆæˆæœ¬ä¼˜åŒ–ï¼‰

ç”±äºLLMè¯„ä¼°æœ‰æˆæœ¬ï¼Œå¯ä»¥æ§åˆ¶é¢‘ç‡ï¼š

```python
# é€‰é¡¹1ï¼šå…¨é‡è¯„ä¼°ï¼ˆ180æ¬¡/agentï¼‰
evaluate_all = True

# é€‰é¡¹2ï¼šé‡‡æ ·è¯„ä¼°ï¼ˆèŠ‚çœæˆæœ¬ï¼‰
evaluate_sample_rate = 0.2  # åªè¯„ä¼°20%çš„å†³ç­–
# 180 * 0.2 = 36æ¬¡/agent
# 5 agents * 36 = 180æ¬¡LLMè°ƒç”¨ï¼ˆè€Œé900æ¬¡ï¼‰

# é€‰é¡¹3ï¼šå…³é”®æ—¶åˆ»è¯„ä¼°
evaluate_at_key_moments = True
# - æ¯ä¸ªroundçš„å‰5æ¬¡å’Œå5æ¬¡å†³ç­–
# - å¼€ä»“/å¹³ä»“çš„å†³ç­–
# - æŠ«éœ²ç‚¹å‰åçš„å†³ç­–
# â‰ˆ 50æ¬¡/agent
```

---

## ğŸ’» Green Agentå¤šè½®äº¤äº’æ ¸å¿ƒå®ç°

### åˆå§‹åŒ–æ—¶è®¾ç½®

```python
class TradingEvaluatorTools:
    def __init__(self, config: Dict):
        # ... åŸæœ‰åˆå§‹åŒ– ...
        
        # å¤šè½®äº¤äº’é…ç½®
        self.enable_multi_round = config.get('enable_multi_round', False)
        self.disclosure_days = config.get('disclosure_days', [])  # [7, 14, 21]
        
        # å­˜å‚¨æ•°æ®
        self.round_decisions: List[AgentRoundDecision] = []
        self.disclosure_packages: List[DisclosurePackage] = []
        self.current_round = 0
```

### ä¸»å¾ªç¯ä¸­çš„å…³é”®é€»è¾‘

```python
async def run_competition(self):
    """ä¸»ç«èµ›å¾ªç¯ï¼š180ä¸ªå†³ç­–å‘¨æœŸ"""
    
    # ç”Ÿæˆ4å°æ—¶Kçº¿æ—¶é—´æˆ³
    timestamps = pd.date_range(
        start=self.config['start_date'],
        end=self.config['end_date'],
        freq='4H'  # 4å°æ—¶é¢‘ç‡
    )
    
    for cycle_idx, timestamp in enumerate(timestamps, 1):
        print(f"\n{'='*60}")
        print(f"å†³ç­–å‘¨æœŸ #{cycle_idx}/180")
        print(f"æ—¶é—´: {timestamp} | Round {self.current_round + 1}")
        print(f"{'='*60}")
        
        # 1. æ£€æŸ¥æ˜¯å¦éœ€è¦æŠ«éœ²ï¼ˆåœ¨è¯¥å‘¨æœŸå¼€å§‹å‰ï¼‰
        if cycle_idx in self.config['disclosure_cycles']:  # [42, 84, 126]
            disclosure = self.create_disclosure_package(cycle_idx, timestamp)
            print(f"ğŸ“¢ æŠ«éœ²ç‚¹{len(self.disclosure_packages)} å·²åˆ›å»º")
        
        # 2. ä¸ºæ¯ä¸ªagentæ„å»ºpromptï¼ˆåŒ…å«å†å²æŠ«éœ²ä¿¡æ¯ï¼‰
        for agent_name in self.agent_names:
            prompt = self.build_market_prompt(agent_name, cycle_idx, timestamp)
            
            # 3. è·å–agentå†³ç­–ï¼ˆA2Aé€šä¿¡ï¼‰
            decision = await self.get_agent_decision(agent_name, prompt)
            
            # 4. å­˜å‚¨è¯¥å†³ç­–ï¼ˆç”¨äºåç»­æŠ«éœ²ï¼‰â­
            self.store_round_decision(agent_name, cycle_idx, decision)
            
            # 5. æ‰§è¡Œäº¤æ˜“
            self.execute_decision(agent_name, decision, timestamp)
        
        # 6. æ›´æ–°è¯¥å‘¨æœŸçŠ¶æ€
        self.update_cycle_state(cycle_idx, timestamp)
    
    print(f"\nğŸ ç«èµ›ç»“æŸï¼å…±å®Œæˆ {len(timestamps)} ä¸ªå†³ç­–å‘¨æœŸ")
```

### æ ¸å¿ƒæ–¹æ³•1: store_round_decision

```python
def store_round_decision(
    self,
    agent_name: str,
    day: int,
    decision: TradingDecision
):
    """å­˜å‚¨agentçš„å†³ç­–ï¼Œç”¨äºåç»­æŠ«éœ²"""
    
    # è§£æreasoningç»“æ„
    parsed = self._parse_reasoning_structure(decision.reasoning)
    
    round_decision = AgentRoundDecision(
        agent_name=agent_name,
        day=day,
        round=self.current_round,
        market_view=parsed.get('market_view', ''),
        opponent_analysis=parsed.get('opponent_analysis'),
        strategy_adjustment=parsed.get('strategy_adjustment'),
        actions=decision.actions,
        full_reasoning=decision.reasoning
    )
    
    self.round_decisions.append(round_decision)

def _parse_reasoning_structure(self, reasoning: str) -> Dict:
    """ä»reasoningæ–‡æœ¬ä¸­æå–ç»“æ„åŒ–ä¿¡æ¯"""
    result = {}
    
    # æå–å¸‚åœºè§‚ç‚¹ï¼ˆç¬¬ä¸€æ®µæˆ–"å¸‚åœºåˆ†æ"éƒ¨åˆ†ï¼‰
    if "å¸‚åœºåˆ†æ:" in reasoning:
        market_section = reasoning.split("å¸‚åœºåˆ†æ:")[1].split("\n")[0]
        result['market_view'] = market_section.strip()
    
    # æå–å¯¹æ‰‹åˆ†æï¼ˆRound 2+æ‰ä¼šæœ‰ï¼‰
    if "å¯¹æ‰‹åˆ†æ:" in reasoning:
        opponent_section = reasoning.split("å¯¹æ‰‹åˆ†æ:")[1].split("\n\n")[0]
        # è§£ææˆdict: {agent_name: analysis}
        result['opponent_analysis'] = self._parse_opponent_section(opponent_section)
    
    # æå–ç­–ç•¥è°ƒæ•´
    if "ç­–ç•¥è°ƒæ•´:" in reasoning:
        strategy_section = reasoning.split("ç­–ç•¥è°ƒæ•´:")[1].split("\n\n")[0]
        result['strategy_adjustment'] = strategy_section.strip()
    
    return result
```

### æ ¸å¿ƒæ–¹æ³•2: create_disclosure_package

```python
def create_disclosure_package(self, day: int) -> DisclosurePackage:
    """åœ¨æŠ«éœ²æ—¥åˆ›å»ºå®Œæ•´çš„æƒ…æŠ¥åŒ…"""
    
    self.current_round += 1
    
    # 1. ç”Ÿæˆæ’è¡Œæ¦œ
    leaderboard = self._get_current_leaderboard()
    
    # 2. æ±‡æ€»æ¯ä¸ªagentåœ¨è¯¥roundçš„è¡¨ç°
    agents_summary = []
    for agent_name in self.agent_names:
        # è·å–è¯¥agentåœ¨å½“å‰roundçš„æ‰€æœ‰å†³ç­–
        agent_decisions = [
            d for d in self.round_decisions
            if d.agent_name == agent_name and d.round == self.current_round - 1
        ]
        
        # æ±‡æ€»ä¿¡æ¯
        summary = {
            'name': agent_name,
            'market_views': [d.market_view for d in agent_decisions if d.market_view],
            'opponent_analysis': agent_decisions[-1].opponent_analysis if agent_decisions and agent_decisions[-1].opponent_analysis else None,
            'strategy_adjustment': agent_decisions[-1].strategy_adjustment if agent_decisions and agent_decisions[-1].strategy_adjustment else None,
            'actions_summary': self._summarize_actions(agent_decisions),
            'positions': self._get_positions_snapshot(agent_name),
            'pnl_pct': self._calculate_pnl_pct(agent_name),
            'equity': self.accounts[agent_name].get_total_equity(self.current_prices)
        }
        agents_summary.append(summary)
    
    # 3. åˆ›å»ºæŠ«éœ²åŒ…
    disclosure = DisclosurePackage(
        round_number=self.current_round,
        disclosure_day=day,
        leaderboard=leaderboard,
        agents_round_summary=agents_summary
    )
    
    self.disclosure_packages.append(disclosure)
    
    # 4. æ‰“å°æŠ«éœ²ä¿¡æ¯ï¼ˆæ—¥å¿—ï¼‰
    self._print_disclosure(disclosure)
    
    return disclosure

def _get_current_leaderboard(self) -> List[Dict]:
    """ç”Ÿæˆå½“å‰æ’è¡Œæ¦œ"""
    rankings = []
    for agent_name in self.agent_names:
        pnl_pct = self._calculate_pnl_pct(agent_name)
        equity = self.accounts[agent_name].get_total_equity(self.current_prices)
        rankings.append({
            'name': agent_name,
            'pnl_pct': pnl_pct,
            'equity': equity
        })
    
    # æŒ‰PnLæ’åº
    rankings.sort(key=lambda x: x['pnl_pct'], reverse=True)
    
    # æ·»åŠ æ’å
    for i, r in enumerate(rankings, 1):
        r['rank'] = i
    
    return rankings
```

### æ ¸å¿ƒæ–¹æ³•3: build_market_prompt (æ‰©å±•ç‰ˆ)

```python
def build_market_prompt(self, agent_name: str, day: int) -> str:
    """æ„å»ºåŒ…å«å¯¹æ‰‹æƒ…æŠ¥çš„å®Œæ•´prompt"""
    
    # 1. åŸºç¡€å¸‚åœºæ•°æ®éƒ¨åˆ†ï¼ˆåŸæœ‰ï¼‰
    prompt = self._build_base_market_data(agent_name, day)
    
    # 2. æ·»åŠ å¯¹æ‰‹æƒ…æŠ¥éƒ¨åˆ†ï¼ˆå¤šè½®äº¤äº’ï¼‰â­
    if self.enable_multi_round and self.disclosure_packages:
        prompt += "\n" + "="*60 + "\n"
        prompt += "ğŸ“Š å¯¹æ‰‹æƒ…æŠ¥ (INTELLIGENCE REPORT)\n"
        prompt += "="*60 + "\n\n"
        
        for disclosure in self.disclosure_packages:
            prompt += f"ã€æŠ«éœ²ç‚¹{disclosure.round_number} - ç¬¬{disclosure.disclosure_day}å¤©ã€‘\n\n"
            
            # 2.1 æ’è¡Œæ¦œ
            prompt += "å½“å‰æ’å:\n"
            for rank_data in disclosure.leaderboard:
                emoji = "ğŸ‘‘" if rank_data['rank'] == 1 else f"{rank_data['rank']}."
                is_you = "(ä½ )" if rank_data['name'] == agent_name else ""
                prompt += f"  {emoji} {rank_data['name']}{is_you}: {rank_data['pnl_pct']:+.2f}% (${rank_data['equity']:.2f})\n"
            
            prompt += "\n"
            
            # 2.2 å¯¹æ‰‹è¯¦ç»†ä¿¡æ¯ï¼ˆè·³è¿‡è‡ªå·±ï¼‰
            for agent_summary in disclosure.agents_round_summary:
                if agent_summary['name'] == agent_name:
                    continue  # è·³è¿‡è‡ªå·±
                
                prompt += f"â”â” {agent_summary['name']} â”â”\n"
                
                # å¸‚åœºè§‚ç‚¹
                if agent_summary['market_views']:
                    prompt += f"  å¸‚åœºè§‚ç‚¹: {agent_summary['market_views'][-1]}\n"
                
                # å¯¹æ‰‹åˆ†æï¼ˆå¦‚æœæœ‰ï¼‰
                if agent_summary.get('opponent_analysis'):
                    prompt += f"  å¯¹æ‰‹åˆ†æ: {agent_summary['opponent_analysis']}\n"
                
                # ç­–ç•¥è°ƒæ•´ï¼ˆå¦‚æœæœ‰ï¼‰
                if agent_summary.get('strategy_adjustment'):
                    prompt += f"  ç­–ç•¥è°ƒæ•´: {agent_summary['strategy_adjustment']}\n"
                
                # æ‰§è¡ŒåŠ¨ä½œ
                prompt += f"  æ‰§è¡ŒåŠ¨ä½œ: {agent_summary['actions_summary']}\n"
                
                # æŒä»“
                prompt += f"  å½“å‰æŒä»“: {agent_summary['positions']}\n"
                
                # PnL
                prompt += f"  å½“å‰ç›ˆäº: {agent_summary['pnl_pct']:+.2f}%\n"
                
                prompt += "\n"
            
            prompt += "-"*60 + "\n\n"
        
        # 2.3 æç¤ºagentåˆ†æå¯¹æ‰‹
        prompt += "\nğŸ’¡ åŸºäºä»¥ä¸Šå¯¹æ‰‹æƒ…æŠ¥ï¼Œä½ å¯ä»¥ï¼š\n"
        prompt += "1. è¯„ä¼°å¯¹æ‰‹çš„reasoningè´¨é‡å’ŒæˆåŠŸç‡\n"
        prompt += "2. åˆ¤æ–­å“ªäº›ç­–ç•¥åœ¨å½“å‰å¸‚åœºæœ‰æ•ˆ\n"
        prompt += "3. å†³å®šè·Ÿéšã€å¯¹æŠ—è¿˜æ˜¯ä¿æŒç‹¬ç«‹\n"
        prompt += "4. åœ¨<reasoning>ä¸­æ·»åŠ <opponent_analysis>å’Œ<strategy_adjustment>éƒ¨åˆ†\n\n"
    
    return prompt
```

---

## ğŸ”¢ è¯„ä¼°æŒ‡æ ‡è¯¦è§£

### Return Metrics (æ”¶ç›ŠæŒ‡æ ‡)
- **Total Return %**: (æœ€ç»ˆå‡€å€¼ - åˆå§‹èµ„é‡‘) / åˆå§‹èµ„é‡‘ Ã— 100%
- **Total Return USD**: ç»å¯¹æ”¶ç›Šé‡‘é¢
- **CAGR**: (æœ€ç»ˆå‡€å€¼ / åˆå§‹èµ„é‡‘)^(365/å¤©æ•°) - 1

### Risk Metrics (é£é™©æŒ‡æ ‡)
- **Sharpe Ratio**: (å¹³å‡æ—¥æ”¶ç›Š / æ”¶ç›Šæ ‡å‡†å·®) Ã— âˆš365 â­ **æ ¸å¿ƒæŒ‡æ ‡**
- **Max Drawdown**: (å³°å€¼ - è°·åº•) / å³°å€¼ Ã— 100%
- **Volatility**: æ—¥æ”¶ç›Šæ ‡å‡†å·® Ã— âˆš365
- **Sortino Ratio**: (å¹³å‡æ”¶ç›Š / ä¸‹è¡Œæ ‡å‡†å·®) Ã— âˆš365
- **Calmar Ratio**: CAGR / Max Drawdown

### Trading Metrics (äº¤æ˜“æŒ‡æ ‡)
- **Total Trades**: å®Œæˆçš„äº¤æ˜“æ¬¡æ•°ï¼ˆå¼€+å¹³ç®—2æ¬¡ï¼‰â­
- **Win Rate**: ç›ˆåˆ©äº¤æ˜“æ•° / æ€»äº¤æ˜“æ•° Ã— 100%
- **Profit Factor**: æ€»ç›ˆåˆ© / æ€»äºæŸ
- **Avg Trades/Day**: æ€»äº¤æ˜“æ•° / å¤©æ•°
- **Avg Holding Time**: å¹³å‡æŒä»“å°æ—¶æ•°

### Scoring Dimensions (è¯„åˆ†ç»´åº¦ 0-1)

#### A. äº¤æ˜“ç»©æ•ˆåˆ†æ•° (Trading Performance) - 70%æƒé‡

**1. Profitability (ç›ˆåˆ©èƒ½åŠ›) - 25%æƒé‡**
- è®¡ç®—ï¼šmin(CAGR / 20%, 1.0)
- æ ‡å‡†ï¼š20%ä»¥ä¸ŠCAGR = æ»¡åˆ†

**2. Risk Management (é£é™©ç®¡ç†) - 25%æƒé‡**
- è®¡ç®—ï¼šmax(1.0 - MaxDD / 20%, 0)
- æ ‡å‡†ï¼š0%å›æ’¤ = æ»¡åˆ†ï¼Œ20%ä»¥ä¸Š = 0åˆ†

**3. Consistency (ä¸€è‡´æ€§) - 20%æƒé‡**
- è®¡ç®—ï¼š(WinRate/80% Ã— 0.5 + ProfitFactor/3.0 Ã— 0.5)
- æ ‡å‡†ï¼š80%èƒœç‡+3.0ç›ˆäºæ¯” = æ»¡åˆ†

**4. Efficiency (æ•ˆç‡) - 20%æƒé‡** â­
- è®¡ç®—ï¼šmin(Sharpe / 2.0, 1.0)
- æ ‡å‡†ï¼šå¤æ™®æ¯”ç‡2.0ä»¥ä¸Š = æ»¡åˆ†

**5. Robustness (ç¨³å¥æ€§) - 10%æƒé‡**
- è®¡ç®—ï¼šmax(1.0 - Volatility / 30%, 0)
- æ ‡å‡†ï¼š0%æ³¢åŠ¨ = æ»¡åˆ†ï¼Œ30%ä»¥ä¸Š = 0åˆ†

**äº¤æ˜“ç»©æ•ˆå¾—åˆ†ï¼š**
```python
trading_score = (
    profitability_score * 0.25 +
    risk_management_score * 0.25 +
    consistency_score * 0.20 +
    efficiency_score * 0.20 +
    robustness_score * 0.10
)  # æ»¡åˆ†1.0
```

#### B. Reasoningè´¨é‡åˆ†æ•° (Reasoning Quality) - 30%æƒé‡ â­ æ–°å¢

**6. Reasoningç»¼åˆè¯„åˆ†** - åŸºäºLLMè¯„ä¼°180æ¬¡å†³ç­–
- ç”±LLM judgeè¯„ä¼°æ¯æ¬¡reasoningçš„5ä¸ªç»´åº¦
- å–180æ¬¡è¯„ä¼°çš„å¹³å‡åˆ†
- è¯¦è§"LLMè¯„ä¼°Reasoningè´¨é‡"ç« èŠ‚

**æœ€ç»ˆå¾—åˆ† = äº¤æ˜“ç»©æ•ˆ(70%) + Reasoningè´¨é‡(30%)**
```python
final_score = trading_score * 0.70 + reasoning_score * 0.30
```

---

## ğŸ”„ å®Œæ•´äº¤äº’æµç¨‹

### Phase 1: åˆå§‹åŒ–

```
Green Agentå¯åŠ¨
â”œâ”€ ä»Binance APIè·å–å†å²æ•°æ®
â”‚  â”œâ”€ BTCUSDT: 2024-11-14 è‡³ 2024-12-14
â”‚  â”œâ”€ ETHUSDT: 2024-11-14 è‡³ 2024-12-14
â”‚  â””â”€ SOLUSDT: 2024-11-14 è‡³ 2024-12-14
â”‚
â”œâ”€ è®¡ç®—æŠ€æœ¯æŒ‡æ ‡
â”‚  â”œâ”€ EMA20, EMA50
â”‚  â”œâ”€ MACD, MACD Signal
â”‚  â”œâ”€ RSI7, RSI14
â”‚  â””â”€ ATR14
â”‚
â”œâ”€ åˆ›å»º5ä¸ªéš”ç¦»è´¦æˆ·ï¼ˆæ¯ä¸ªç‹¬ç«‹çš„BacktestAccountï¼‰
â”‚  â”œâ”€ ConservativeTrader: $10,000ç°é‡‘, 0æŒä»“
â”‚  â”œâ”€ BalancedTrader: $10,000ç°é‡‘, 0æŒä»“
â”‚  â”œâ”€ AggressiveTrader: $10,000ç°é‡‘, 0æŒä»“
â”‚  â”œâ”€ MomentumTrader: $10,000ç°é‡‘, 0æŒä»“
â”‚  â””â”€ MeanReversionTrader: $10,000ç°é‡‘, 0æŒä»“
â”‚
â”œâ”€ å®šä¹‰å€™é€‰å¸ç§æ± 
â”‚  â””â”€ æ‰€æœ‰agentså¯äº¤æ˜“: ["BTCUSDT", "ETHUSDT", "SOLUSDT"]
â”‚
â””â”€ éªŒè¯æ•°æ®å®Œæ•´æ€§ âœ…
```

### Phase 2: ä¸»å¾ªç¯ (æ¯4å°æ—¶ä¸€æ¬¡å†³ç­–ï¼Œå…±180æ¬¡)

```
For each 4-hour candle (2024-11-14 00:00 è‡³ 2024-12-14 20:00ï¼Œå…±180æ ¹Kçº¿):

  1. è·å–å½“å‰4å°æ—¶Kçº¿çš„å¸‚åœºæ•°æ®
     â”œâ”€ BTC: OHLCV + æŠ€æœ¯æŒ‡æ ‡
     â”œâ”€ ETH: OHLCV + æŠ€æœ¯æŒ‡æ ‡
     â””â”€ SOL: OHLCV + æŠ€æœ¯æŒ‡æ ‡
     â””â”€ æ—¶é—´æˆ³: 2024-11-14 08:00 (ç¤ºä¾‹)
  
  2. ä¸ºæ¯ä¸ªAgentæ„å»ºä¸ªæ€§åŒ–Prompt â­ å…³é”®æ­¥éª¤
     
     å¯¹ ConservativeTrader:
     â”œâ”€ è¯»å–å…¶BacktestAccount:
     â”‚  â”œâ”€ ç°é‡‘ä½™é¢: $9,800
     â”‚  â”œâ”€ å½“å‰æŒä»“: 
     â”‚  â”‚  â””â”€ BTC 0.05 Long @ $87,234 (ç›ˆäº: +$93.45, +2.1%)
     â”‚  â””â”€ æ€»å‡€å€¼: $9,893.45
     â”‚
     â”œâ”€ æä¾›å€™é€‰å¸ç§ï¼ˆå®Œæ•´æŠ€æœ¯æŒ‡æ ‡ï¼‰:
     â”‚  â”œâ”€ BTCUSDT (å½“å‰ä»·$89,105, EMA20=$88,500, MACD=0.25, RSI7=65)
     â”‚  â”œâ”€ ETHUSDT (å½“å‰ä»·$3,142, EMA20=$3,100, MACD=0.15, RSI7=58)
     â”‚  â””â”€ SOLUSDT (å½“å‰ä»·$218, EMA20=$215, MACD=-0.05, RSI7=48)
     â”‚
     â””â”€ æ„å»ºå®Œæ•´Promptï¼ˆåŒ…å«æŒä»“+å€™é€‰å¸+æŠ€æœ¯æŒ‡æ ‡ï¼‰
     
     å¯¹å…¶ä»–4ä¸ªAgentsé‡å¤ç›¸åŒæµç¨‹ï¼ˆå„è‡ªç‹¬ç«‹çš„è´¦æˆ·çŠ¶æ€ï¼‰
  
  3. å¹¶è¡Œå‘é€ç»™æ‰€æœ‰Agents (A2Aé€šä¿¡)
     ConservativeTrader â† ä¸ªæ€§åŒ–Promptï¼ˆå«å…¶æŒä»“ï¼‰
     BalancedTrader â† ä¸ªæ€§åŒ–Promptï¼ˆå«å…¶æŒä»“ï¼‰
     AggressiveTrader â† ä¸ªæ€§åŒ–Promptï¼ˆå«å…¶æŒä»“ï¼‰
     MomentumTrader â† ä¸ªæ€§åŒ–Promptï¼ˆå«å…¶æŒä»“ï¼‰
     MeanReversionTrader â† ä¸ªæ€§åŒ–Promptï¼ˆå«å…¶æŒä»“ï¼‰
  
  4. æ”¶é›†å†³ç­– (XMLæ ¼å¼)
     ConservativeTrader â†’ <decision>[wait]</decision>
     BalancedTrader â†’ <decision>[open_long BTC 5x]</decision>
     AggressiveTrader â†’ <decision>[open_long BTC 10x]</decision>
     MomentumTrader â†’ <decision>[open_long ETH 8x]</decision>
     MeanReversionTrader â†’ <decision>[open_short BTC 3x]</decision>
  
  5. è§£æXMLå†³ç­–
     æå– <summary>, <reasoning>, <decision>
     éªŒè¯å†³ç­–æœ‰æ•ˆæ€§
  
  6. å­˜å‚¨è¯¥è½®å†³ç­– â­ å¤šè½®äº¤äº’
     â”œâ”€ è®°å½•æ¯ä¸ªagentçš„ï¼š
     â”‚  â”œâ”€ å¸‚åœºè§‚ç‚¹ (ä»reasoningæå–)
     â”‚  â”œâ”€ å¯¹æ‰‹åˆ†æ (Round 2+æ‰æœ‰)
     â”‚  â”œâ”€ ç­–ç•¥è°ƒæ•´ (Round 2+æ‰æœ‰)
     â”‚  â”œâ”€ æ‰§è¡ŒåŠ¨ä½œ
     â”‚  â””â”€ å®Œæ•´reasoning
     â””â”€ ç”¨äºåç»­æŠ«éœ²ç‚¹
  
  7. æ‰§è¡Œäº¤æ˜“ï¼ˆéš”ç¦»è´¦æˆ·ï¼‰
     å¯¹æ¯ä¸ªagent:
     â”œâ”€ æ£€æŸ¥ä½™é¢æ˜¯å¦è¶³å¤Ÿ
     â”œâ”€ åº”ç”¨æ»‘ç‚¹ (Â±2 bps)
     â”œâ”€ æ‰£é™¤æ‰‹ç»­è´¹ (5 bps)
     â”œâ”€ æ›´æ–°æŒä»“
     â”œâ”€ æ£€æŸ¥æ¸…ç®—ä»·
     â””â”€ è®°å½•äº¤æ˜“æ—¥å¿—
  
  8. æ£€æŸ¥æ˜¯å¦æŠ«éœ²ç‚¹ â­ å¤šè½®äº¤äº’
     If decision_cycle in [42, 84, 126]:  # çº¦Day 7, 14, 21
     â”œâ”€ åˆ›å»ºæŠ«éœ²åŒ…ï¼š
     â”‚  â”œâ”€ æ±‡æ€»æ‰€æœ‰agentsçš„Round Nè¡¨ç°
     â”‚  â”œâ”€ ç”Ÿæˆæ’è¡Œæ¦œ
     â”‚  â””â”€ æ ¼å¼åŒ–å¯¹æ‰‹æƒ…æŠ¥
     â”œâ”€ æ·»åŠ åˆ°disclosure_packagesåˆ—è¡¨
     â””â”€ ä¸‹ä¸€è½®çš„promptå°†åŒ…å«è¿™äº›æƒ…æŠ¥
  
  9. æ›´æ–°çŠ¶æ€
     â”œâ”€ è®¡ç®—æœªå®ç°PnL
     â”œâ”€ è®°å½•å‡€å€¼æ›²çº¿
     â”œâ”€ æ£€æŸ¥æ¸…ç®—æƒ…å†µ
     â””â”€ è¿›å…¥ä¸‹ä¸€ä¸ª4å°æ—¶å‘¨æœŸ
     
Loopå®Œæˆåï¼Œå…±æ‰§è¡Œ180æ¬¡å†³ç­–å¾ªç¯
```

### Phase 3: æœ€ç»ˆè¯„ä¼°

```
ç«èµ›ç»“æŸå:

1. è®¡ç®—æ¯ä¸ªAgentçš„å®Œæ•´æŒ‡æ ‡
   â”œâ”€ Return: æ”¶ç›Šç‡ã€CAGR
   â”œâ”€ Risk: å¤æ™®ã€å›æ’¤ã€æ³¢åŠ¨ç‡
   â””â”€ Trading: äº¤æ˜“æ¬¡æ•°ã€èƒœç‡ã€ç›ˆäºæ¯”

2. è®¡ç®—è¯„åˆ†
   â”œâ”€ Profitability Score
   â”œâ”€ Risk Management Score
   â”œâ”€ Consistency Score
   â”œâ”€ Efficiency Score
   â””â”€ Robustness Score

3. åŠ æƒè®¡ç®—æ€»åˆ†
   Total Score = PÃ—25% + RÃ—25% + CÃ—20% + EÃ—20% + RbÃ—10%

4. æ’å
   æŒ‰Total Scoreé™åºæ’åˆ—

5. ç”ŸæˆæŠ¥å‘Š
   â”œâ”€ æ’è¡Œæ¦œ
   â”œâ”€ è¯¦ç»†æŒ‡æ ‡
   â”œâ”€ ç­–ç•¥åˆ†æ
   â””â”€ å…³é”®æ´å¯Ÿ

6. è¾“å‡ºCompetitionResult
```
